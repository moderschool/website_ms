<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern School Kota - Management System</title>
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --radius: 0.5rem;
            --radius-sm: 0.25rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.5;
        }

        /* Layout */
        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-right: 1px solid var(--gray-200);
            display: flex;
            flex-direction: column;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            margin-left: 40%;
            width: 50px;
            height: 70px;
           
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.25rem;
        }

        .logo-text h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .logo-text p {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        .nav-section {
            padding: 1.5rem;
            flex: 1;
            overflow-y: auto;
        }

        .nav-group {
            margin-bottom: 1.5rem;
        }

        .nav-group-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--gray-500);
            margin-bottom: 0.75rem;
            padding-left: 0.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            margin-bottom: 0.25rem;
            border-radius: var(--radius-sm);
            color: var(--gray-700);
            text-decoration: none;
            transition: all 0.2s;
            cursor: pointer;
        }

        .nav-item:hover {
            background-color: var(--gray-100);
            color: var(--gray-900);
        }

        .nav-item.active {
            background-color: var(--primary);
            color: white;
        }

        .nav-item i {
            margin-right: 0.75rem;
            font-size: 1.25rem;
            width: 24px;
            text-align: center;
        }

        .nav-item span {
            font-weight: 500;
            font-size: 0.9375rem;
        }

        .nav-badge {
            margin-left: auto;
            background-color: var(--danger);
            color: white;
            font-size: 0.75rem;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
        }

        .sidebar-footer {
            padding: 0.25rem;
            border-top: 1px solid var(--gray-200);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--info), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }

        .user-info h4 {
            font-size: 0.9375rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .user-info p {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Top Bar */
        .top-bar {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .page-title h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }

        .page-title p {
            font-size: 0.875rem;
            color: var(--gray-500);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .breadcrumb {
            color: var(--primary);
            font-weight: 500;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: var(--gray-50);
        }

        /* Page Container */
        .page-container {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page-container.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Card */
        .card {
            background: white;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: all 0.2s;
        }

        .card:hover {
            box-shadow: var(--shadow);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .card-body {
            padding: 1.5rem;
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-icon.primary {
            background: linear-gradient(135deg, var(--primary), #3b82f6);
        }

        .stat-icon.success {
            background: linear-gradient(135deg, var(--success), #34d399);
        }

        .stat-icon.warning {
            background: linear-gradient(135deg, var(--warning), #fbbf24);
        }

        .stat-icon.info {
            background: linear-gradient(135deg, var(--info), #22d3ee);
        }

        .stat-content h3 {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--gray-900);
            line-height: 1;
            margin-bottom: 0.25rem;
        }

        .stat-content p {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .quick-action-button {
            padding: 1.5rem;
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            color: inherit;
        }

        .quick-action-button:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .quick-action-button i {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .quick-action-text h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.25rem;
        }

        .quick-action-text p {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        /* Activity Feed */
        .activity-feed {
            background: white;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }

        .activity-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--gray-100);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-700);
            font-size: 1.125rem;
        }

        .activity-content {
            flex: 1;
        }

        .activity-content p {
            font-size: 0.875rem;
            color: var(--gray-700);
            margin-bottom: 0.25rem;
        }

        .activity-content span {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        .form-control {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed var(--gray-300);
            border-radius: var(--radius);
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--gray-50);
        }

        .file-upload:hover {
            border-color: var(--primary);
            background: rgba(37, 99, 235, 0.02);
        }

        .file-upload i {
            font-size: 3rem;
            color: var(--gray-400);
            margin-bottom: 1rem;
        }

        .file-upload h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        .file-upload p {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        /* Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .data-table thead {
            background: var(--gray-50);
            border-bottom: 2px solid var(--gray-200);
        }

        .data-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--gray-700);
            white-space: nowrap;
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--gray-200);
            color: var(--gray-700);
        }

        .data-table tbody tr:hover {
            background: var(--gray-50);
        }

        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            gap: 0.25rem;
        }

        .status-active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-draft {
            background: #e0e7ff;
            color: #3730a3;
        }

        .status-closed {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--gray-300);
            background: white;
            color: var(--gray-600);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
        }

        .btn-icon:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--gray-50);
        }

        .btn-icon.edit:hover {
            border-color: var(--info);
            color: var(--info);
        }

        .btn-icon.delete:hover {
            border-color: var(--danger);
            color: var(--danger);
        }

        /* Action Button */
        .action-button {
            padding: 0.625rem 1.25rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
            text-decoration: none;
        }

        .action-button:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .action-button.secondary {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .action-button.secondary:hover {
            background: var(--gray-200);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray-600);
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .tab:hover {
            color: var(--gray-900);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.2s ease-out;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        .modal-large {
            max-width: 1000px;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--gray-500);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-200);
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }

        /* Chat Interface */
        .chat-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            height: 600px;
            background: white;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }

        .chat-sidebar {
            border-right: 1px solid var(--gray-200);
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .chat-header h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .chat-users {
            flex: 1;
            overflow-y: auto;
        }

        .chat-user {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--gray-100);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chat-user:hover,
        .chat-user.active {
            background: var(--gray-50);
        }

        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .chat-user-info {
            flex: 1;
        }

        .chat-user-info h4 {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.125rem;
        }

        .chat-user-info p {
            font-size: 0.75rem;
            color: var(--gray-500);
        }

        .chat-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--gray-300);
        }

        .chat-status.online {
            background: var(--success);
        }

        .chat-main {
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .message.received {
            background: var(--gray-100);
            align-self: flex-start;
        }

        .message.sent {
            background: var(--primary);
            color: white;
            align-self: flex-end;
        }

        .message-input {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--gray-200);
            display: flex;
            gap: 0.75rem;
        }

        .message-input textarea {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            resize: none;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .message-input textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Toast */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .toast {
            padding: 1rem 1.25rem;
            background: white;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .toast-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }

        .toast.success .toast-icon {
            background: var(--success);
            color: white;
        }

        .toast.error .toast-icon {
            background: var(--danger);
            color: white;
        }

        .toast.info .toast-icon {
            background: var(--info);
            color: white;
        }

        .toast-content {
            flex: 1;
        }

        .toast-content p {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--gray-900);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--gray-500);
            cursor: pointer;
            padding: 0.25rem;
        }

        /* Loading */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--gray-200);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Tags */
        .tag {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .tag-academic {
            background: #e0e7ff;
            color: #3730a3;
        }

        .tag-non-academic {
            background: #fce7f3;
            color: #9d174d;
        }

        /* Search and Filter */
        .search-filter {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-button {
            padding: 0.5rem 1rem;
            background: white;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-button:hover,
        .filter-button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* User Avatar */
        .application-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.25rem;
        }

        /* Application Preview */
        .application-preview {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 2rem;
            align-items: start;
        }

        .application-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-label {
            font-size: 0.75rem;
            color: var(--gray-500);
            font-weight: 500;
        }

        .info-value {
            font-size: 0.875rem;
            color: var(--gray-900);
            font-weight: 500;
        }

        /* Communication Buttons */
        .communication-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .com-btn {
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            border: none;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }

        .com-btn.whatsapp {
            background: #25D366;
            color: white;
        }

        .com-btn.email {
            background: var(--primary);
            color: white;
        }

        .com-btn.call {
            background: var(--success);
            color: white;
        }

        .com-btn.print {
            background: var(--gray-700);
            color: white;
        }

        .com-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        /* Security Settings */
        .security-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .security-card {
            background: white;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            padding: 1.5rem;
        }

        .security-card h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 1rem;
        }

        .security-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--gray-100);
        }

        .security-item:last-child {
            border-bottom: none;
        }

        .security-item label {
            font-size: 0.875rem;
            color: var(--gray-700);
        }

        /* IP Address List */
        .ip-list {
            background: var(--gray-50);
            border-radius: var(--radius);
            padding: 1rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .ip-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: white;
            border-radius: var(--radius-sm);
            margin-bottom: 0.5rem;
            border: 1px solid var(--gray-200);
        }

        /* User Roles */
        .role-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .role-card {
            background: white;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            padding: 1.5rem;
        }

        .role-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .role-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .role-permissions {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .permission-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--gray-100);
        }

        .permission-item:last-child {
            border-bottom: none;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                z-index: 1000;
                width: 280px;
                box-shadow: var(--shadow-lg);
            }
            
            .sidebar.active {
                display: flex;
            }
            
            .menu-toggle {
                display: flex;
            }
        }

        @media (max-width: 768px) {
            .content-area {
                padding: 1rem;
            }
            
            .top-bar {
                padding: 1rem;
            }
            
            .chat-container {
                grid-template-columns: 1fr;
                height: 500px;
            }
            
            .chat-sidebar {
                display: none;
            }
            
            .modal-content {
                max-width: 95%;
            }
        }

        @media (max-width: 640px) {
            .dashboard-grid,
            .stats-grid,
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .application-preview {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        /* Menu Toggle */
        .menu-toggle {
            display: none;
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            border: 1px solid var(--gray-300);
            background: white;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--gray-700);
        }

        @media (max-width: 1200px) {
            .menu-toggle {
                display: flex;
            }
        }

        /* Print Styles */
        @media print {
            .sidebar,
            .top-bar,
            .modal-close,
            .action-buttons,
            .communication-buttons {
                display: none !important;
            }
            
            .modal-content {
                box-shadow: none;
                border: none;
            }
            
            .modal-body {
                padding: 0;
            }
        }
        /* Enhanced Search Input */
.search-box {
    position: relative;
    flex: 1;
    min-width: 280px;
    max-width: 500px;
}

.search-input {
    width: 100%;
    padding: 0.75rem 1rem 0.75rem 2.75rem;
    border: 1px solid var(--gray-300);
    border-radius: var(--radius);
    font-size: 0.9375rem;
    transition: all 0.2s ease;
    background: white;
}

.search-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
}

.search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-500);
    font-size: 1.25rem;
    pointer-events: none;
}

/* Optional: Add subtle background when focused */
.search-box:focus-within {
    position: relative;
}

.search-box:focus-within::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: calc(var(--radius) + 2px);
    background: linear-gradient(45deg, var(--primary), var(--secondary));
    z-index: -1;
    opacity: 0.15;
    pointer-events: none;
}
  .sidebar {
    background: white;
    border-right: 1px solid var(--gray-200);
    display: flex;
    flex-direction: column;
    position: sticky;
    top: 0;
    height: 100vh;
    overflow-y: auto;
}

/* Reduce padding in header and sections */
.sidebar-header {
    padding: 1.25rem 1rem;           /* ← was 1.5rem */
}

.nav-section {
    padding: 1rem 0.75rem;            /* ← reduced from 1.5rem */
}

.nav-group {
    margin-bottom: 1rem;              /* ← was 1.5rem */
}

.nav-item {
    padding: 0.65rem 1rem;            /* ← was 0.75rem */
    margin-bottom: 0.15rem;           /* tighter spacing */
}

.nav-group-title {
    padding-left: 1rem;
    margin-bottom: 0.5rem;            /* ← was 0.75rem */
}

.sidebar-footer {
    padding: 1rem;                    /* ← was 1.5rem */
}

/* Optional: make icons & text tighter */
.nav-item i {
    margin-right: 0.85rem;            /* ← was 0.75rem */
    font-size: 1.375rem;              /* slightly bigger icons look better in compact view */
}

.nav-item span {
    font-size: 0.925rem;              /* ← was 0.9375rem */
}
  </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
              
               <center> <b>WebApp Console</b></center>
            </div>
            
            <div class="nav-section">
                <div class="nav-group">
                    <div class="nav-group-title">Main</div>
                    <a href="#" class="nav-item active" data-page="dashboard">
                        <i class="material-icons-round">dashboard</i>
                        <span>Dashboard</span>
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Career Management</div>
                    <a href="#" class="nav-item" data-page="careers">
                        <i class="material-icons-round">work</i>
                        <span>Career Postings</span>
                        <span class="nav-badge" id="careerBadge">8</span>
                    </a>
                    <a href="#" class="nav-item" data-page="applications">
                        <i class="material-icons-round">description</i>
                        <span>Applications</span>
                        <span class="nav-badge" id="applicationBadge">24</span>
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Content Management</div>
                    <a href="#" class="nav-item" data-page="blogs">
                        <i class="material-icons-round">article</i>
                        <span>Blogs</span>
                    </a>
                    <a href="#" class="nav-item" data-page="carousels">
                        <i class="material-icons-round">collections</i>
                        <span>Carousels</span>
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Admission & Enquiries</div>
                    <a href="#" class="nav-item" data-page="enquiries">
                        <i class="material-icons-round">inbox</i>
                        <span>Enquiries</span>
                        <span class="nav-badge" id="enquiryBadge">42</span>
                    </a>
                    <a href="#" class="nav-item" data-page="chat">
                        <i class="material-icons-round">chat</i>
                        <span>Live Chat</span>
                        <span class="nav-badge" id="chatBadge">3</span>
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">Data Management</div>
                    <a href="#" class="nav-item" data-page="tc">
                        <i class="material-icons-round">description</i>
                        <span>TC Data</span>
                    </a>
                    <a href="#" class="nav-item" data-page="timetable">
                        <i class="material-icons-round">calendar_today</i>
                        <span>Timetables</span>
                    </a>
                </div>
                
                <div class="nav-group">
                    <div class="nav-group-title">System</div>
                    <a href="#" class="nav-item" data-page="security">
                        <i class="material-icons-round">security</i>
                        <span>Security</span>
                    </a>
                    <a href="#" class="nav-item" data-page="users">
                        <i class="material-icons-round">people</i>
                        <span>Users</span>
                    </a>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="user-profile" >
                    <div class="user-avatar">JF</div>
                    <div class="user-info">
                        <h4>John Savio Fernandes</h4>
                        <p>Super Administrator</p>
                    </div>
                    <i class="material-icons-round" id="userMenuToggle" style="margin-left: auto; color: var(--gray-400); cursor: pointer;">more_vert</i>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="material-icons-round">menu</i>
                    </button>
                    <div class="page-title">
                        <h1 id="pageTitle">Dashboard</h1>
                        <p>
                            <span class="breadcrumb" id="breadcrumb">Dashboard</span>
                            <i class="material-icons-round" style="font-size: 16px;">chevron_right</i>
                            <span id="pageSubtitle">Overview</span>
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Content Area -->
            <div class="content-area" id="contentArea">
                <!-- All pages will be loaded here -->
               <div id="dashboardPage" class="page-container active">
    <!-- Dashboard content will be injected here by JavaScript -->
</div>
                <div id="careersPage" class="page-container"></div>
                <div id="applicationsPage" class="page-container"></div>
                <div id="blogsPage" class="page-container"></div>
                <div id="carouselsPage" class="page-container"></div>
                <div id="enquiriesPage" class="page-container"></div>
                <div id="chatPage" class="page-container"></div>
                <div id="tcPage" class="page-container"></div>
                <div id="timetablePage" class="page-container"></div>
                <div id="securityPage" class="page-container"></div>
                <div id="usersPage" class="page-container"></div>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- Modals -->
    <div class="modal" id="newCareerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Career Posting</h3>
                <button class="modal-close" onclick="hideModal('newCareerModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <form id="careerForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Job Title</label>
                            <input type="text" class="form-control" id="jobTitle" placeholder="e.g., Mathematics Teacher" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Department</label>
                            <select class="form-control" id="jobDepartment" required>
                                <option value="">Select Department</option>
                                <option value="Teaching">Teaching</option>
                                <option value="Administration">Administration</option>
                                <option value="Support">Support Staff</option>
                                <option value="Management">Management</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Position Type</label>
                            <div class="filter-group" style="margin-top: 0.5rem;">
                                <button type="button" class="filter-button active" onclick="setPositionType('academic')">Academic</button>
                                <button type="button" class="filter-button" onclick="setPositionType('non-academic')">Non-Academic</button>
                            </div>
                            <input type="hidden" id="positionType" value="academic">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Application Deadline</label>
                            <input type="date" class="form-control" id="jobDeadline" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Job Description</label>
                        <textarea class="form-control" id="jobDescription" rows="4" placeholder="Detailed job description..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Requirements</label>
                        <textarea class="form-control" id="jobRequirements" rows="3" placeholder="Qualifications and experience required..." required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Job Type</label>
                            <select class="form-control" id="jobType">
                                <option value="Full-time">Full-time</option>
                                <option value="Part-time">Part-time</option>
                                <option value="Contract">Contract</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Application Method</label>
                            <select class="form-control" id="applicationMethod">
                                <option value="Online">Online only</option>
                                <option value="Offline">Offline only</option>
                                <option value="Both">Both online and offline</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <label class="toggle-switch">
                                <input type="checkbox" id="jobStatus" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span id="statusText" style="font-size: 0.875rem; color: var(--gray-700);">Active</span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('newCareerModal')">Cancel</button>
                <button class="action-button" onclick="saveCareer()">Post Career</button>
            </div>
        </div>
    </div>
    
    <!-- Career Detail Modal -->
    <div class="modal" id="careerDetailModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="detailJobTitle">Job Title</h3>
                <button class="modal-close" onclick="hideModal('careerDetailModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <div class="application-preview">
                    <div>
                        <div class="application-info">
                            <div class="info-item">
                                <span class="info-label">Department</span>
                                <span class="info-value" id="detailDepartment">Teaching</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Posted Date</span>
                                <span class="info-value" id="detailPostedDate">2023-10-15</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Deadline</span>
                                <span class="info-value" id="detailDeadline">2023-11-30</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Applications</span>
                                <span class="info-value" id="detailApplications">24</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Job Type</span>
                                <span class="info-value" id="detailJobType">Full-time</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Position Type</span>
                                <span class="info-value"><span id="detailPositionType" class="tag tag-academic">Academic</span></span>
                            </div>
                        </div>
                        
                        <div style="margin-top: 2rem;">
                            <label class="form-label">Status</label>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="detailJobStatus">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="detailStatusText" style="font-size: 0.875rem; color: var(--gray-700);">Active</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="form-group">
                            <label class="form-label">Job Description</label>
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-sm);" id="detailDescription">
                                Detailed job description...
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Requirements</label>
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-sm);" id="detailRequirements">
                                Qualifications and requirements...
                            </div>
                        </div>
                        
                        <div class="modal-footer" style="padding: 1.5rem 0 0 0; border-top: 1px solid var(--gray-200);">
                            <button class="action-button secondary" onclick="hideModal('careerDetailModal')">
                                Close
                            </button>
                            <button class="action-button" id="viewApplicationsBtn">
                                <i class="material-icons-round">list</i>
                                View Applications
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Application Detail Modal -->
    <div class="modal" id="applicationDetailModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Application Details</h3>
                <button class="modal-close" onclick="hideModal('applicationDetailModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <div class="application-preview">
                    <div>
                        <div class="application-avatar" id="applicationAvatar">RK</div>
                        <div class="communication-buttons" style="margin-top: 1.5rem;">
                            <button class="com-btn whatsapp" onclick="sendWhatsApp()">
                                <i class="material-icons-round">chat</i>
                                WhatsApp
                            </button>
                            <button class="com-btn email" onclick="sendEmail()">
                                <i class="material-icons-round">mail</i>
                                Email
                            </button>
                            <button class="com-btn call" onclick="makeCall()">
                                <i class="material-icons-round">phone</i>
                                Call
                            </button>
                            <button class="com-btn print" onclick="printApplication()">
                                <i class="material-icons-round">print</i>
                                Print
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <div class="application-info">
                            <div class="info-item">
                                <span class="info-label">Full Name</span>
                                <span class="info-value" id="appName">Rajesh Kumar</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Email</span>
                                <span class="info-value" id="appEmail">rajesh.kumar@email.com</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Phone</span>
                                <span class="info-value" id="appPhone">+91 98765 43210</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Applied For</span>
                                <span class="info-value" id="appJob">Mathematics Teacher</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Application Date</span>
                                <span class="info-value" id="appDate">2023-10-18</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Application Method</span>
                                <span class="info-value" id="appMethod">Online</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Status</span>
                                <span class="info-value" id="appStatus">Pending</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Experience</span>
                                <span class="info-value" id="appExperience">5 years</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Qualification</span>
                                <span class="info-value" id="appQualification">M.Sc Mathematics</span>
                            </div>
                        </div>
                        
                        <div style="margin-top: 1.5rem;">
                            <label class="form-label">Cover Letter</label>
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-sm); min-height: 100px;" id="appCoverLetter">
                                Cover letter content...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Enquiry Detail Modal -->
    <div class="modal" id="enquiryDetailModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Enquiry Details <span id="enquiryNumber" style="font-size: 0.875rem; color: var(--gray-500);">#ENQ001</span></h3>
                <button class="modal-close" onclick="hideModal('enquiryDetailModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <div class="application-preview">
                    <div>
                        <div class="application-avatar" id="enquiryAvatar">RK</div>
                        <div class="communication-buttons" style="margin-top: 1.5rem;">
                            <button class="com-btn whatsapp" onclick="enquiryWhatsApp()">
                                <i class="material-icons-round">chat</i>
                                WhatsApp
                            </button>
                            <button class="com-btn email" onclick="enquiryEmail()">
                                <i class="material-icons-round">mail</i>
                                Email
                            </button>
                            <button class="com-btn call" onclick="enquiryCall()">
                                <i class="material-icons-round">phone</i>
                                Call
                            </button>
                        </div>
                        
                        <div style="margin-top: 1.5rem;">
                            <label class="form-label">Enquiry Status</label>
                            <div class="filter-group">
                                <button class="filter-button" onclick="markAsRead()">Mark as Read</button>
                                <button class="filter-button" onclick="markAsUnread()">Mark as Unread</button>
                                <button class="filter-button" onclick="moveToFollowup()">Move to Followup</button>
                                <button class="filter-button" onclick="moveToConverted()">Move to Converted</button>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="application-info">
                            <div class="info-item">
                                <span class="info-label">Full Name</span>
                                <span class="info-value" id="enquiryName">Rajesh Kumar</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Email</span>
                                <span class="info-value" id="enquiryEmail">rajesh@email.com</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Phone</span>
                                <span class="info-value" id="enquiryPhone">+91 98765 43210</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Enquiry Type</span>
                                <span class="info-value" id="enquiryType">Admission</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Date</span>
                                <span class="info-value" id="enquiryDate">2023-10-18</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Source</span>
                                <span class="info-value" id="enquirySource">Website</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Status</span>
                                <span class="info-value" id="enquiryStatus">New Lead</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Student Class</span>
                                <span class="info-value" id="enquiryClass">Class X</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Preferred Contact Time</span>
                                <span class="info-value" id="enquiryTime">10:00 AM - 5:00 PM</span>
                            </div>
                        </div>
                        
                        <div style="margin-top: 1.5rem;">
                            <label class="form-label">Enquiry Message</label>
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-sm); min-height: 100px;" id="enquiryMessage">
                                Detailed enquiry message...
                            </div>
                        </div>
                        
                        <div style="margin-top: 1.5rem;">
                            <label class="form-label">Follow-up Notes</label>
                            <textarea class="form-control" id="enquiryNotes" rows="3" placeholder="Add follow-up notes..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('enquiryDetailModal')">
                    Close
                </button>
                <button class="action-button" onclick="saveEnquiryNotes()">
                    Save Notes
                </button>
            </div>
        </div>
    </div>
    
    <!-- Blog Edit Modal -->
    <div class="modal" id="blogEditModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="blogModalTitle">Edit Blog Post</h3>
                <button class="modal-close" onclick="hideModal('blogEditModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <form id="blogEditForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Blog Title</label>
                            <input type="text" class="form-control" id="blogTitle" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-control" id="blogCategory">
                                <option value="academics">Academics</option>
                                <option value="events">Events</option>
                                <option value="announcements">Announcements</option>
                                <option value="tips">Tips & Advice</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Featured Image</label>
                        <div class="file-upload" onclick="uploadBlogImage()">
                            <i class="material-icons-round">cloud_upload</i>
                            <h4>Upload Featured Image</h4>
                            <p>Recommended size: 1200x600 pixels</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Content</label>
                        <textarea class="form-control" id="blogContent" rows="10" placeholder="Write your blog content here..."></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Visibility</label>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="blogVisibility" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="visibilityText" style="font-size: 0.875rem; color: var(--gray-700);">Visible on Website</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Publish Date</label>
                            <input type="date" class="form-control" id="blogPublishDate">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('blogEditModal')">
                    Cancel
                </button>
                <button class="action-button" onclick="saveBlog()">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
    
    <!-- Carousel Edit Modal -->
    <div class="modal" id="carouselEditModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Carousel Image</h3>
                <button class="modal-close" onclick="hideModal('carouselEditModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <form id="carouselEditForm">
                    <div class="form-group">
                        <label class="form-label">Image</label>
                        <div class="file-upload" onclick="uploadCarouselImage()">
                            <i class="material-icons-round">image</i>
                            <h4>Upload Image</h4>
                            <p id="carouselRatioText">2:1 ratio required</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Title Text</label>
                        <input type="text" class="form-control" id="carouselTitle" placeholder="Enter title">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Description Text</label>
                        <textarea class="form-control" id="carouselDescription" rows="3" placeholder="Enter description"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Button Text</label>
                            <input type="text" class="form-control" id="carouselButtonText" placeholder="Learn More">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Button Link</label>
                            <input type="text" class="form-control" id="carouselButtonLink" placeholder="/page-url">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Visibility</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <label class="toggle-switch">
                                <input type="checkbox" id="carouselVisibility" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span style="font-size: 0.875rem; color: var(--gray-700);">Visible on Homepage</span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('carouselEditModal')">
                    Cancel
                </button>
                <button class="action-button" onclick="saveCarousel()">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
    
    <!-- Chat Modal -->
    <div class="modal" id="chatModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Live Chat Support</h3>
                <button class="modal-close" onclick="hideModal('chatModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <div class="chat-container">
                    <div class="chat-sidebar">
                        <div class="chat-header">
                            <h3>Active Conversations (<span id="activeChatCount">3</span>)</h3>
                        </div>
                        <div class="chat-users" id="chatUsers">
                            <!-- Chat users loaded dynamically -->
                        </div>
                    </div>
                    
                    <div class="chat-main">
                        <div class="chat-header" style="border-bottom: 1px solid var(--gray-200);">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div class="chat-avatar" id="currentChatAvatar">RS</div>
                                <div>
                                    <h3 id="currentChatName">Select a conversation</h3>
                                    <p id="currentChatInfo" style="font-size: 0.75rem; color: var(--gray-500);">Click on a user to start chatting</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chat-messages" id="chatMessages">
                            <!-- Chat messages loaded dynamically -->
                        </div>
                        
                        <div class="message-input">
                            <textarea id="chatInput" placeholder="Type your message..." disabled></textarea>
                            <button class="action-button" id="sendMessage" style="align-self: flex-end;" disabled>
                                <i class="material-icons-round">send</i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" id="endChatBtn" disabled>
                    <i class="material-icons-round">call_end</i>
                    End Chat
                </button>
                <button class="action-button secondary" id="convertToEnquiryBtn" disabled>
                    <i class="material-icons-round">forward_to_inbox</i>
                    Convert to Enquiry
                </button>
            </div>
        </div>
    </div>
    
    <!-- User Settings Modal -->
    <div class="modal" id="userSettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>User Settings - John Savio Fernandes</h3>
                <button class="modal-close" onclick="hideModal('userSettingsModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Change Password</label>
                    <input type="password" class="form-control" id="currentPassword" placeholder="Current Password">
                    <input type="password" class="form-control" style="margin-top: 0.5rem;" id="newPassword" placeholder="New Password">
                    <input type="password" class="form-control" style="margin-top: 0.5rem;" id="confirmPassword" placeholder="Confirm New Password">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Allowed IP Addresses</label>
                    <div class="ip-list" id="allowedIPs">
                        <!-- IP addresses loaded dynamically -->
                    </div>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <input type="text" class="form-control" id="newIP" placeholder="Add new IP address">
                        <button class="action-button" onclick="addIP()">Add</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Allowed Locations</label>
                    <div class="ip-list" id="allowedLocations">
                        <!-- Locations loaded dynamically -->
                    </div>
                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                        <input type="text" class="form-control" id="newLocation" placeholder="Add location (e.g., India)">
                        <button class="action-button" onclick="addLocation()">Add</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="toggle-switch" style="display: flex; align-items: center; gap: 0.5rem;">
                        <input type="checkbox" id="restrictAccess">
                        <span class="toggle-slider"></span>
                        Restrict access to specific IPs and locations only
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('userSettingsModal')">
                    Cancel
                </button>
                <button class="action-button" onclick="saveUserSettings()">
                    Save Settings
                </button>
            </div>
        </div>
    </div>
    
    <!-- Security Settings Modal -->
    <div class="modal" id="securitySettingsModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Security Settings</h3>
                <button class="modal-close" onclick="hideModal('securitySettingsModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body" id="securitySettingsContent">
                <!-- Security content loaded dynamically -->
            </div>
        </div>
    </div>
    
    <!-- TC Data Entry Modal -->
    <div class="modal" id="tcDataModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="tcModalTitle">Add TC Data</h3>
                <button class="modal-close" onclick="hideModal('tcDataModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body" id="tcDataForm">
                <!-- TC form loaded dynamically -->
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('tcDataModal')">
                    Cancel
                </button>
                <button class="action-button" onclick="saveTCData()">
                    Save TC Data
                </button>
            </div>
        </div>
    </div>
    
    <!-- Timetable Entry Modal -->
    <div class="modal" id="timetableModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="timetableModalTitle">Add Timetable</h3>
                <button class="modal-close" onclick="hideModal('timetableModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body" id="timetableForm">
                <!-- Timetable form loaded dynamically -->
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('timetableModal')">
                    Cancel
                </button>
                <button class="action-button" onclick="saveTimetable()">
                    Save Timetable
                </button>
            </div>
        </div>
    </div>
    
    <!-- User Management Modal -->
    <div class="modal" id="userManagementModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="userModalTitle">Add New User</h3>
                <button class="modal-close" onclick="hideModal('userManagementModal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body" id="userForm">
                <!-- User form loaded dynamically -->
            </div>
            <div class="modal-footer">
                <button class="action-button secondary" onclick="hideModal('userManagementModal')">
                    Cancel
                </button>
                <button class="action-button" onclick="saveUser()">
                    Save User
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Application State
        const state = {
            currentPage: 'dashboard',
            currentChat: null,
            careers: [
                {
                    id: 1,
                    title: 'Mathematics Teacher',
                    department: 'Teaching',
                    postedDate: '2023-10-15',
                    deadline: '2023-11-30',
                    applications: 24,
                    status: 'active',
                    type: 'Full-time',
                    method: 'Online',
                    positionType: 'academic',
                    description: 'Looking for a qualified Mathematics Teacher for Class 9-12. Must have at least 3 years of teaching experience and a Master\'s degree in Mathematics.',
                    requirements: 'M.Sc in Mathematics, B.Ed required, 3+ years teaching experience, Good communication skills'
                },
                {
                    id: 2,
                    title: 'Science Lab Assistant',
                    department: 'Support',
                    postedDate: '2023-10-10',
                    deadline: '2023-11-20',
                    applications: 18,
                    status: 'active',
                    type: 'Full-time',
                    method: 'Both',
                    positionType: 'non-academic',
                    description: 'Assist in science laboratory setup, maintenance, and support during practical sessions.',
                    requirements: 'B.Sc in Science, Laboratory experience, Attention to detail'
                },
                {
                    id: 3,
                    title: 'Administrative Officer',
                    department: 'Administration',
                    postedDate: '2023-10-05',
                    deadline: '2023-10-31',
                    applications: 32,
                    status: 'closed',
                    type: 'Full-time',
                    method: 'Both',
                    positionType: 'non-academic',
                    description: 'Handle administrative tasks and office management.',
                    requirements: 'Bachelor\'s degree, 2+ years experience, Good organizational skills'
                }
            ],
            applications: [
                {
                    id: 1,
                    name: 'Rajesh Kumar',
                    email: 'rajesh.kumar@email.com',
                    phone: '+91 98765 43210',
                    job: 'Mathematics Teacher',
                    date: '2023-10-18',
                    status: 'pending',
                    method: 'online',
                    experience: '5 years',
                    qualification: 'M.Sc Mathematics, B.Ed',
                    coverLetter: 'I am writing to express my interest in the Mathematics Teacher position. With 5 years of experience teaching mathematics to high school students, I have developed a strong understanding of how to make complex mathematical concepts accessible and engaging.',
                    jobId: 1
                },
                {
                    id: 2,
                    name: 'Priya Sharma',
                    email: 'priya.sharma@email.com',
                    phone: '+91 87654 32109',
                    job: 'Science Lab Assistant',
                    date: '2023-10-16',
                    status: 'shortlisted',
                    method: 'offline',
                    experience: '3 years',
                    qualification: 'B.Sc Chemistry',
                    coverLetter: 'I am excited to apply for the Science Lab Assistant position. I have 3 years of experience working in educational laboratories and am proficient in maintaining lab equipment and assisting students.',
                    jobId: 2
                },
                {
                    id: 3,
                    name: 'Amit Patel',
                    email: 'amit.patel@email.com',
                    phone: '+91 76543 21098',
                    job: 'Administrative Officer',
                    date: '2023-10-12',
                    status: 'reviewed',
                    method: 'online',
                    experience: '4 years',
                    qualification: 'B.Com, MBA',
                    coverLetter: 'I have extensive experience in administrative roles and office management.',
                    jobId: 3
                }
            ],
            enquiries: [
                {
                    id: 1,
                    name: 'Rajesh Kumar',
                    email: 'rajesh@email.com',
                    phone: '+91 98765 43210',
                    type: 'Admission',
                    date: '2023-10-18',
                    source: 'Website',
                    status: 'new',
                    class: 'Class X',
                    contactTime: '10:00 AM - 5:00 PM',
                    message: 'I would like to know about the admission process for Class X for the academic year 2024-25.',
                    notes: '',
                    enquiryNumber: 'ENQ001'
                },
                {
                    id: 2,
                    name: 'Priya Verma',
                    email: 'priya.verma@email.com',
                    phone: '+91 87654 32109',
                    type: 'Fee Structure',
                    date: '2023-10-17',
                    source: 'Website',
                    status: 'read',
                    class: 'Class XI',
                    contactTime: '9:00 AM - 4:00 PM',
                    message: 'Could you please share the fee structure for Class XI Science stream?',
                    notes: 'Sent fee structure via email',
                    enquiryNumber: 'ENQ002'
                },
                {
                    id: 3,
                    name: 'Rahul Sharma',
                    email: 'rahul.sharma@email.com',
                    phone: '+91 76543 21098',
                    type: 'Scholarship',
                    date: '2023-10-15',
                    source: 'Phone',
                    status: 'followup',
                    class: 'Class XII',
                    contactTime: '11:00 AM - 6:00 PM',
                    message: 'Inquiry about scholarship programs for meritorious students.',
                    notes: 'Follow up next week',
                    enquiryNumber: 'ENQ003'
                }
            ],
            blogs: [
                {
                    id: 1,
                    title: 'How to Prepare for Board Exams',
                    category: 'academics',
                    content: 'Essential tips and strategies for students preparing for board examinations.',
                    publishDate: '2023-10-12',
                    visible: true,
                    image: 'gradient-1'
                },
                {
                    id: 2,
                    title: 'Science Fair 2023 Winners',
                    category: 'events',
                    content: 'Celebrating the innovative projects and achievements of our students.',
                    publishDate: '2023-10-05',
                    visible: true,
                    image: 'gradient-2'
                }
            ],
            activeChats: [
                {
                    id: 1,
                    name: 'Rahul Sharma',
                    email: 'rahul.sharma@email.com',
                    phone: '+91 98765 43210',
                    status: 'online',
                    lastActivity: 'Just now',
                    messages: [
                        { type: 'received', text: 'Hello, I have a question about admission process.', time: '10:30 AM' },
                        { type: 'sent', text: 'Hello Rahul! How can I help you with the admission process?', time: '10:31 AM' },
                        { type: 'received', text: 'I want to know about the documents required for Class XI admission.', time: '10:32 AM' }
                    ]
                },
                {
                    id: 2,
                    name: 'Priya Verma',
                    email: 'priya.verma@email.com',
                    phone: '+91 87654 32109',
                    status: 'away',
                    lastActivity: '5 minutes ago',
                    messages: [
                        { type: 'received', text: 'Is there any scholarship available for meritorious students?', time: '9:45 AM' },
                        { type: 'sent', text: 'Yes, we have several scholarship programs. Could you tell me which class you are inquiring for?', time: '9:46 AM' }
                    ]
                },
                {
                    id: 3,
                    name: 'Amit Patel',
                    email: 'amit.patel@email.com',
                    phone: '+91 76543 21098',
                    status: 'online',
                    lastActivity: '2 minutes ago',
                    messages: [
                        { type: 'received', text: 'Can I get information about school transportation?', time: '11:15 AM' },
                        { type: 'sent', text: 'Yes, we provide transportation services across the city. What is your location?', time: '11:16 AM' }
                    ]
                }
            ],
            securitySettings: {
                websiteVisibility: true,
                pageVisibility: {
                    academics: true,
                    curriculum: true,
                    calendar: true,
                    timetable: true,
                    tuitionFees: true,
                    cbseCorner: true,
                    disclosures: true,
                    alumni: true,
                    studentCounsel: true,
                    events: true,
                    athletics: true,
                    campusFacilities: true,
                    history: true,
                    vision: true,
                    leadership: true,
                    adminTeam: true,
                    location: true,
                    career: true,
                    tcVerification: true,
                    branches: true
                },
                chatEnabled: true,
                websiteTour: true,
                bannedIPs: ['192.168.1.100', '10.0.0.5'],
                bannedCountries: ['North Korea', 'China', 'Iran', 'Pakistan'],
                allowedCountries: ['India', 'USA', 'UK', 'Canada', 'Australia'],
                requireLogin: true,
                sessionTimeout: 30,
                maxLoginAttempts: 5
            },
            users: [
                {
                    id: 1,
                    name: 'John Savio Fernandes',
                    role: 'super-admin',
                    email: 'john.fernandes@school.edu',
                    password: 'admin123',
                    permissions: {
                        dashboard: true,
                        careers: true,
                        applications: true,
                        blogs: true,
                        carousels: true,
                        enquiries: true,
                        chat: true,
                        tc: true,
                        timetable: true,
                        security: true,
                        users: true
                    }
                },
                {
                    id: 2,
                    name: 'Priya Sharma',
                    role: 'hr',
                    email: 'priya.sharma@school.edu',
                    password: 'hr123',
                    permissions: {
                        dashboard: true,
                        careers: true,
                        applications: true,
                        enquiries: false,
                        chat: false,
                        tc: false,
                        timetable: false,
                        security: false,
                        users: false
                    }
                },
                {
                    id: 3,
                    name: 'Rajesh Kumar',
                    role: 'admission',
                    email: 'rajesh.kumar@school.edu',
                    password: 'admission123',
                    permissions: {
                        dashboard: true,
                        careers: false,
                        applications: false,
                        enquiries: true,
                        chat: true,
                        tc: false,
                        timetable: false,
                        security: false,
                        users: false
                    }
                }
            ],
            tcData: [
                {
                    id: 1,
                    studentName: 'Rahul Sharma',
                    admissionNo: '2020-001',
                    academicYear: '2022-2023',
                    class: 'XII',
                    dateOfIssue: '2023-05-20',
                    status: 'active'
                },
                {
                    id: 2,
                    studentName: 'Priya Patel',
                    admissionNo: '2020-002',
                    academicYear: '2022-2023',
                    class: 'XII',
                    dateOfIssue: '2023-05-22',
                    status: 'active'
                },
                {
                    id: 3,
                    studentName: 'Amit Verma',
                    admissionNo: '2020-003',
                    academicYear: '2021-2022',
                    class: 'XII',
                    dateOfIssue: '2022-05-25',
                    status: 'inactive'
                }
            ],
            timetables: [
                {
                    id: 1,
                    class: 'X',
                    term: 'Term 1',
                    dateRange: 'Nov 1-15, 2023',
                    status: 'active',
                    subjects: [
                        { day: 'Monday', time: '9:00-10:00', subject: 'Mathematics' },
                        { day: 'Monday', time: '10:00-11:00', subject: 'Science' }
                    ]
                },
                {
                    id: 2,
                    class: 'XII',
                    term: 'Term 1',
                    dateRange: 'Nov 5-20, 2023',
                    status: 'active',
                    subjects: [
                        { day: 'Monday', time: '9:00-10:30', subject: 'Physics' },
                        { day: 'Monday', time: '10:30-12:00', subject: 'Chemistry' }
                    ]
                }
            ],
            carousels: [
                {
                    id: 1,
                    type: 'carousel1',
                    ratio: '2:1',
                    title: 'Welcome to Modern School',
                    description: 'Excellence in Education Since 1995',
                    buttonText: 'Learn More',
                    buttonLink: '/about',
                    visible: true
                },
                {
                    id: 2,
                    type: 'carousel2',
                    ratio: '1:2',
                    title: 'Admissions Open',
                    description: '2024-25 Academic Year',
                    buttonText: 'Apply Now',
                    buttonLink: '/admissions',
                    visible: true
                }
            ]
        };

        // Initialize
 document.addEventListener('DOMContentLoaded', function() {

    // 1. Sabse pehle badge update kar do
    updateBadgeCounts();

    // 2. Event listeners laga do
    setupEventListeners();

    // 3. Sab pages ko forcefully hide kar do (safety ke liye)
    document.querySelectorAll('.page-container').forEach(el => {
        el.classList.remove('active');
        el.style.display = 'none';  // extra safety
    });

    // 4. Dashboard ko seedha dikhado (sabse important step)
    const dashboard = document.getElementById('dashboardPage');
    if (dashboard) {
        dashboard.innerHTML = getDashboardContent();     // content daal do
        dashboard.classList.add('active');
        dashboard.style.display = 'block';              // force visible
    }

    // 5. Navigation mein bhi dashboard active dikhao
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    const dashboardNav = document.querySelector('.nav-item[data-page="dashboard"]');
    if (dashboardNav) {
        dashboardNav.classList.add('active');
    }

    // 6. State bhi update kar do taaki baad mein koi confusion na ho
    state.currentPage = 'dashboard';

    // 7. Title bhi sahi kar do
    document.getElementById('pageTitle').textContent = 'Dashboard';
    document.getElementById('breadcrumb').textContent = 'Dashboard';
    document.getElementById('pageSubtitle').textContent = 'Overview';

    console.log("Dashboard forcefully loaded on page start");
});
        function initializeApp() {
            // Set default dates
            const nextMonth = new Date();
            nextMonth.setMonth(nextMonth.getMonth() + 1);
            const deadlineInput = document.getElementById('jobDeadline');
            if (deadlineInput) {
                deadlineInput.valueAsDate = nextMonth;
            }
            
            // Update badge counts
            updateBadgeCounts();
            
            // Setup event listeners
            setupEventListeners();
            
            // Load initial page
            loadPage('dashboard');
        }

        function updateBadgeCounts() {
            // Update career badge
            const activeCareers = state.careers.filter(c => c.status === 'active').length;
            document.getElementById('careerBadge').textContent = activeCareers;
            
            // Update application badge
            document.getElementById('applicationBadge').textContent = state.applications.length;
            
            // Update enquiry badge
            const newEnquiries = state.enquiries.filter(e => e.status === 'new').length;
            document.getElementById('enquiryBadge').textContent = newEnquiries;
            
            // Update chat badge
            const activeChats = state.activeChats.filter(c => c.status === 'online').length;
            document.getElementById('chatBadge').textContent = activeChats;
        }

        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    navigateTo(page);
                });
            });

            // Menu toggle
            document.getElementById('menuToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
            });

            // User menu toggle
            document.getElementById('userMenuToggle').addEventListener('click', function() {
                showModal('userSettingsModal');
            });

            // Career form status toggle
            const jobStatusToggle = document.getElementById('jobStatus');
            if (jobStatusToggle) {
                jobStatusToggle.addEventListener('change', function() {
                    document.getElementById('statusText').textContent = this.checked ? 'Active' : 'Inactive';
                });
            }

            // Career detail status toggle
            const detailJobStatusToggle = document.getElementById('detailJobStatus');
            if (detailJobStatusToggle) {
                detailJobStatusToggle.addEventListener('change', function() {
                    const status = this.checked ? 'Active' : 'Inactive';
                    document.getElementById('detailStatusText').textContent = status;
                    // Update career status in state
                    const careerId = parseInt(document.getElementById('detailJobTitle').getAttribute('data-id'));
                    if (careerId) {
                        const career = state.careers.find(c => c.id === careerId);
                        if (career) {
                            career.status = this.checked ? 'active' : 'inactive';
                            showToast(`Career status updated to ${status.toLowerCase()}`, 'success');
                        }
                    }
                });
            }

            // Chat input enter key
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendChatMessage();
                    }
                });
            }

            // Send message button
            const sendMessageBtn = document.getElementById('sendMessage');
            if (sendMessageBtn) {
                sendMessageBtn.addEventListener('click', sendChatMessage);
            }

            // End chat button
            const endChatBtn = document.getElementById('endChatBtn');
            if (endChatBtn) {
                endChatBtn.addEventListener('click', endChat);
            }

            // Convert to enquiry button
            const convertToEnquiryBtn = document.getElementById('convertToEnquiryBtn');
            if (convertToEnquiryBtn) {
                convertToEnquiryBtn.addEventListener('click', convertChatToEnquiry);
            }

            // View applications button
            const viewApplicationsBtn = document.getElementById('viewApplicationsBtn');
            if (viewApplicationsBtn) {
                viewApplicationsBtn.addEventListener('click', function() {
                    const careerId = parseInt(document.getElementById('detailJobTitle').getAttribute('data-id'));
                    if (careerId) {
                        viewApplicationsForJob(careerId);
                    }
                });
            }

            // Close modals on overlay click
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        hideModal(this.id);
                    }
                });
            });
        }

        function navigateTo(page) {
            state.currentPage = page;
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const navItem = document.querySelector(`[data-page="${page}"]`);
            if (navItem) {
                navItem.classList.add('active');
            }
            
            // Update page title
            updatePageTitle(page);
            
            // Load page
            loadPage(page);
            
            // Close sidebar on mobile
            if (window.innerWidth < 1200) {
                document.getElementById('sidebar').classList.remove('active');
            }
        }

        function updatePageTitle(page) {
            const titles = {
                dashboard: 'Dashboard',
                careers: 'Career Postings',
                applications: 'Applications',
                blogs: 'Blog Management',
                carousels: 'Carousel Management',
                enquiries: 'Enquiry Management',
                chat: 'Live Chat',
                tc: 'TC Data Management',
                timetable: 'Exam Timetables',
                security: 'Security Settings',
                users: 'User Management'
            };
            
            const titleElement = document.getElementById('pageTitle');
            const breadcrumbElement = document.getElementById('breadcrumb');
            const subtitleElement = document.getElementById('pageSubtitle');
            
            if (titleElement) titleElement.textContent = titles[page] || page;
            if (breadcrumbElement) breadcrumbElement.textContent = titles[page] || page;
            if (subtitleElement) subtitleElement.textContent = page === 'dashboard' ? 'Overview' : 'Management';
        }

      function loadPage(page) {
    // Hide all pages and clear content
    document.querySelectorAll('.page-container').forEach(container => {
        container.classList.remove('active');
        container.innerHTML = '';
    });

    const pageElement = document.getElementById(page + 'Page');
    if (!pageElement) return;

    const content = getPageContent(page);

    // Load content immediately (no spinner, no setTimeout)
    pageElement.innerHTML = content;
    pageElement.classList.add('active');
    initializePage(page);
}
   function getPageContent(page) {
            switch(page) {
                case 'dashboard':
                    return getDashboardContent();
                case 'careers':
                    return getCareersContent();
                case 'applications':
                    return getApplicationsContent();
                case 'blogs':
                    return getBlogsContent();
                case 'carousels':
                    return getCarouselsContent();
                case 'enquiries':
                    return getEnquiriesContent();
                case 'chat':
                    return getChatContent();
                case 'tc':
                    return getTCContent();
                case 'timetable':
                    return getTimetableContent();
                case 'security':
                    return getSecurityContent();
                case 'users':
                    return getUsersContent();
                default:
                    return getComingSoonContent();
            }
        }

        function getDashboardContent() {
            const activeCareers = state.careers.filter(c => c.status === 'active').length;
            const newEnquiries = state.enquiries.filter(e => e.status === 'new').length;
            const activeChats = state.activeChats.filter(c => c.status === 'online').length;
            
            return `
                <div class="dashboard-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="material-icons-round">inbox</i>
                            </div>
                            <div class="stat-content">
                                <h3>${state.enquiries.length}</h3>
                                <p>Total Enquiries</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon success">
                                <i class="material-icons-round">work</i>
                            </div>
                            <div class="stat-content">
                                <h3>${activeCareers}</h3>
                                <p>Active Careers</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon warning">
                                <i class="material-icons-round">description</i>
                            </div>
                            <div class="stat-content">
                                <h3>${state.applications.length}</h3>
                                <p>Total Applications</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon info">
                                <i class="material-icons-round">chat</i>
                            </div>
                            <div class="stat-content">
                                <h3>${activeChats}</h3>
                                <p>Active Chats</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="quick-actions">
                        <a href="#" class="quick-action-button" onclick="showModal('newCareerModal')">
                            <i class="material-icons-round">post_add</i>
                            <div class="quick-action-text">
                                <h4>Post New Career</h4>
                                <p>Create job opening</p>
                            </div>
                        </a>
                        
                        <a href="#" class="quick-action-button" onclick="createNewBlog()">
                            <i class="material-icons-round">article</i>
                            <div class="quick-action-text">
                                <h4>Manage Blog</h4>
                                <p>Create or edit posts</p>
                            </div>
                        </a>
                        
                        <a href="#" class="quick-action-button" onclick="navigateTo('tc')">
                            <i class="material-icons-round">upload</i>
                            <div class="quick-action-text">
                                <h4>Upload TC Data</h4>
                                <p>Bulk upload Excel</p>
                            </div>
                        </a>
                        
                        <a href="#" class="quick-action-button" onclick="navigateTo('chat')">
                            <i class="material-icons-round">support_agent</i>
                            <div class="quick-action-text">
                                <h4>Live Chat Support</h4>
                                <p>Talk to visitors</p>
                            </div>
                        </a>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3>Recent Activity</h3>
                            </div>
                            <div class="card-body">
                                <div class="activity-feed">
                                    <div class="activity-item">
                                        <div class="activity-icon">
                                            <i class="material-icons-round">person_add</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>New enquiry from Rajesh Kumar</p>
                                            <span>10 minutes ago</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon">
                                            <i class="material-icons-round">upload</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Exam timetable uploaded for Class X</p>
                                            <span>2 hours ago</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon">
                                            <i class="material-icons-round">chat</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Live chat response sent to Priya Sharma</p>
                                            <span>5 hours ago</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon">
                                            <i class="material-icons-round">work</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>New career posting: Mathematics Teacher</p>
                                            <span>1 day ago</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3>Pending Actions</h3>
                            </div>
                            <div class="card-body">
                                <div class="activity-feed">
                                    <div class="activity-item">
                                        <div class="activity-icon" style="background: #fee2e2; color: #991b1b;">
                                            <i class="material-icons-round">priority_high</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Review ${state.applications.filter(a => a.status === 'pending').length} pending applications</p>
                                            <span>Due today</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon" style="background: #fef3c7; color: #92400e;">
                                            <i class="material-icons-round">schedule</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Follow up with ${state.enquiries.filter(e => e.status === 'followup').length} enquiry leads</p>
                                            <span>Overdue by 2 days</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon" style="background: #d1fae5; color: #065f46;">
                                            <i class="material-icons-round">check_circle</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Update Class XII timetable</p>
                                            <span>Due tomorrow</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon" style="background: #e0e7ff; color: #3730a3;">
                                            <i class="material-icons-round">security</i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Review security logs</p>
                                            <span>Weekly task</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getCareersContent() {
            const activeCareers = state.careers.filter(c => c.status === 'active');
            const closedCareers = state.careers.filter(c => c.status === 'closed');
            
            return `
                <div class="careers-page">
                    <div class="search-filter">
                     <div class="search-box">
    <i class="material-icons-round search-icon">search</i>
    <input type="text" class="search-input" id="careerSearch" placeholder="Search career postings..." onkeyup="searchCareers()">
</div>
                        <div class="filter-group">
                            <button class="filter-button active" onclick="filterCareers('all')">All (${state.careers.length})</button>
                            <button class="filter-button" onclick="filterCareers('academic')">Academic (${state.careers.filter(c => c.positionType === 'academic').length})</button>
                            <button class="filter-button" onclick="filterCareers('non-academic')">Non-Academic (${state.careers.filter(c => c.positionType === 'non-academic').length})</button>
                            <button class="filter-button" onclick="filterCareers('active')">Active (${activeCareers.length})</button>
                            <button class="filter-button" onclick="filterCareers('closed')">Closed (${closedCareers.length})</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Career Postings</h2>
                            <p style="color: var(--gray-500);">Manage all job openings and applications</p>
                        </div>
                        <button class="action-button" onclick="showModal('newCareerModal')">
                            <i class="material-icons-round">add</i>
                            New Posting
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>All Career Postings (${state.careers.length})</h3>
                            <div class="action-buttons">
                                <button class="btn-icon" onclick="exportCareers()">
                                    <i class="material-icons-round">download</i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="data-table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Job Title</th>
                                            <th>Department</th>
                                            <th>Position Type</th>
                                            <th>Posted Date</th>
                                            <th>Deadline</th>
                                            <th>Applications</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="careerTableBody">
                                        ${state.careers.map(career => `
                                            <tr>
                                                <td>
                                                    <div style="font-weight: 600; color: var(--gray-900);">${career.title}</div>
                                                    <div style="font-size: 0.75rem; color: var(--gray-500);">${career.type} • ${career.method}</div>
                                                </td>
                                                <td>${career.department}</td>
                                                <td>
                                                    ${career.positionType === 'academic' ? 
                                                        '<span class="tag tag-academic">Academic</span>' : 
                                                        '<span class="tag tag-non-academic">Non-Academic</span>'}
                                                </td>
                                                <td>${career.postedDate}</td>
                                                <td>${career.deadline}</td>
                                                <td>${career.applications}</td>
                                                <td>
                                                    ${career.status === 'active' ? 
                                                        '<span class="status-badge status-active">Active</span>' : 
                                                        '<span class="status-badge status-closed">Closed</span>'}
                                                </td>
                                                <td>
                                                    <div class="action-buttons">
                                                        <button class="btn-icon" onclick="viewCareerDetail(${career.id})">
                                                            <i class="material-icons-round">visibility</i>
                                                        </button>
                                                        <button class="btn-icon edit" onclick="editCareer(${career.id})">
                                                            <i class="material-icons-round">edit</i>
                                                        </button>
                                                        <button class="btn-icon" onclick="viewApplicationsForJob(${career.id})">
                                                            <i class="material-icons-round">list</i>
                                                        </button>
                                                        <button class="btn-icon delete" onclick="deleteCareer(${career.id})">
                                                            <i class="material-icons-round">delete</i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getApplicationsContent() {
            const pendingApps = state.applications.filter(a => a.status === 'pending');
            const shortlistedApps = state.applications.filter(a => a.status === 'shortlisted');
            const onlineApps = state.applications.filter(a => a.method === 'online');
            const offlineApps = state.applications.filter(a => a.method === 'offline');
            
            return `
                <div class="applications-page">
                    <div class="search-filter">
                        <div class="search-box" style="flex: 1;">
                            <i class="material-icons-round search-icon">search</i>
                            <input type="text" class="search-input" id="applicationSearch" placeholder="Search applications..." onkeyup="searchApplications()">
                        </div>
                        <div class="filter-group">
                            <button class="filter-button active" onclick="filterApplications('all')">All (${state.applications.length})</button>
                            <button class="filter-button" onclick="filterApplications('online')">Online (${onlineApps.length})</button>
                            <button class="filter-button" onclick="filterApplications('offline')">Offline (${offlineApps.length})</button>
                            <button class="filter-button" onclick="filterApplications('pending')">Pending (${pendingApps.length})</button>
                            <button class="filter-button" onclick="filterApplications('shortlisted')">Shortlisted (${shortlistedApps.length})</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Job Applications</h2>
                            <p style="color: var(--gray-500);">Manage all job applications (Online & Offline)</p>
                        </div>
                        <div class="action-buttons">
                            <button class="action-button secondary" onclick="exportApplications()">
                                <i class="material-icons-round">download</i>
                                Export
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-body">
                            <div class="data-table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Applicant</th>
                                            <th>Applied For</th>
                                            <th>Date</th>
                                            <th>Method</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="applicationTableBody">
                                        ${state.applications.map(app => `
                                            <tr>
                                                <td>
                                                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                                                        <div style="width: 32px; height: 32px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), var(--secondary)); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.75rem; font-weight: 600;">
                                                            ${app.name.split(' ').map(n => n[0]).join('')}
                                                        </div>
                                                        <div>
                                                            <div style="font-weight: 600; color: var(--gray-900);">${app.name}</div>
                                                            <div style="font-size: 0.75rem; color: var(--gray-500);">${app.email}</div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>${app.job}</td>
                                                <td>${app.date}</td>
                                                <td>
                                                    <span style="display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.25rem 0.75rem; background: ${app.method === 'online' ? '#dbeafe' : '#f3e8ff'}; color: ${app.method === 'online' ? '#1e40af' : '#6b21a8'}; border-radius: 9999px; font-size: 0.75rem;">
                                                        <i class="material-icons-round" style="font-size: 0.875rem;">${app.method === 'online' ? 'computer' : 'upload_file'}</i>
                                                        ${app.method === 'online' ? 'Online' : 'Offline'}
                                                    </span>
                                                </td>
                                                <td>
                                                    ${app.status === 'pending' ? '<span class="status-badge status-pending">Pending</span>' : ''}
                                                    ${app.status === 'shortlisted' ? '<span class="status-badge status-active">Shortlisted</span>' : ''}
                                                    ${app.status === 'reviewed' ? '<span class="status-badge" style="background: #e0e7ff; color: #3730a3;">Reviewed</span>' : ''}
                                                    ${app.status === 'hired' ? '<span class="status-badge" style="background: #d1fae5; color: #065f46;">Hired</span>' : ''}
                                                </td>
                                                <td>
                                                    <div class="action-buttons">
                                                        <button class="btn-icon" onclick="viewApplicationDetail(${app.id})">
                                                            <i class="material-icons-round">visibility</i>
                                                        </button>
                                                        <button class="btn-icon edit" onclick="editApplication(${app.id})">
                                                            <i class="material-icons-round">edit</i>
                                                        </button>
                                                        <button class="btn-icon" onclick="contactApplicant(${app.id})">
                                                            <i class="material-icons-round">mail</i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getBlogsContent() {
            return `
                <div class="blogs-page">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Blog Management</h2>
                            <p style="color: var(--gray-500);">Create and manage blog posts with images</p>
                        </div>
                        <button class="action-button" onclick="createNewBlog()">
                            <i class="material-icons-round">add</i>
                            New Blog Post
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Blog Posts (${state.blogs.length})</h3>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;" id="blogPostsContainer">
                                ${state.blogs.map(blog => `
                                    <div class="card" style="margin: 0; position: relative;">
                                        <div style="height: 160px; background: linear-gradient(135deg, ${blog.image === 'gradient-1' ? '#667eea 0%, #764ba2 100%' : '#f093fb 0%, #f5576c 100%'}); border-radius: var(--radius-sm) var(--radius-sm) 0 0;"></div>
                                        <div style="position: absolute; top: 1rem; right: 1rem;">
                                            <label class="toggle-switch">
                                                <input type="checkbox" ${blog.visible ? 'checked' : ''} onchange="toggleBlogVisibility(${blog.id}, this.checked)">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div class="card-body">
                                            <h4 style="font-size: 1rem; font-weight: 600; color: var(--gray-900); margin-bottom: 0.5rem;">${blog.title}</h4>
                                            <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 1rem; line-height: 1.5;">${blog.content}</p>
                                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                                <span style="font-size: 0.75rem; color: var(--gray-500);">Posted: ${blog.publishDate}</span>
                                                <div class="action-buttons">
                                                    <button class="btn-icon" onclick="editBlogPost(${blog.id})">
                                                        <i class="material-icons-round">edit</i>
                                                    </button>
                                                    <button class="btn-icon delete" onclick="deleteBlog(${blog.id})">
                                                        <i class="material-icons-round">delete</i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getCarouselsContent() {
            const carousel1 = state.carousels.find(c => c.type === 'carousel1');
            const carousel2 = state.carousels.find(c => c.type === 'carousel2');
            
            return `
                <div class="carousels-page">
                    <div style="margin-bottom: 1.5rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Carousel Management</h2>
                        <p style="color: var(--gray-500);">Manage homepage carousels with specific image ratios</p>
                    </div>
                    
                    <div class="card" style="margin-bottom: 1.5rem;">
                        <div class="card-header">
                            <h3>Carousel 1 (2:1 Ratio)</h3>
                            <button class="action-button" onclick="addCarouselImage('carousel1')">
                                <i class="material-icons-round">add</i>
                                Add Image
                            </button>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
                                <div class="file-upload" style="aspect-ratio: 2/1; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="addCarouselImage('carousel1')">
                                    <div style="text-align: center;">
                                        <i class="material-icons-round" style="font-size: 2rem; color: var(--gray-400); margin-bottom: 0.5rem;">add_photo_alternate</i>
                                        <p style="color: var(--gray-500);">Add 2:1 ratio image</p>
                                    </div>
                                </div>
                                ${carousel1 ? `
                                    <div style="aspect-ratio: 2/1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius); position: relative;">
                                        <div style="position: absolute; top: 0.75rem; right: 0.75rem; display: flex; gap: 0.5rem;">
                                            <button class="btn-icon" style="background: rgba(255,255,255,0.9);" onclick="editCarousel(${carousel1.id})">
                                                <i class="material-icons-round" style="font-size: 1rem;">edit</i>
                                            </button>
                                            <button class="btn-icon delete" style="background: rgba(255,255,255,0.9);" onclick="deleteCarouselImage(${carousel1.id})">
                                                <i class="material-icons-round" style="font-size: 1rem;">delete</i>
                                            </button>
                                        </div>
                                        <div style="position: absolute; bottom: 1rem; left: 1rem; color: white;">
                                            <h4 style="font-weight: 600; margin-bottom: 0.5rem;">${carousel1.title}</h4>
                                            <p style="font-size: 0.875rem;">${carousel1.description}</p>
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Carousel 2 (1:2 Ratio)</h3>
                            <button class="action-button" onclick="addCarouselImage('carousel2')">
                                <i class="material-icons-round">add</i>
                                Add Image
                            </button>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
                                <div class="file-upload" style="aspect-ratio: 1/2; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="addCarouselImage('carousel2')">
                                    <div style="text-align: center;">
                                        <i class="material-icons-round" style="font-size: 2rem; color: var(--gray-400); margin-bottom: 0.5rem;">add_photo_alternate</i>
                                        <p style="color: var(--gray-500);">Add 1:2 ratio image</p>
                                    </div>
                                </div>
                                ${carousel2 ? `
                                    <div style="aspect-ratio: 1/2; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: var(--radius); position: relative;">
                                        <div style="position: absolute; top: 0.75rem; right: 0.75rem; display: flex; gap: 0.5rem;">
                                            <button class="btn-icon" style="background: rgba(255,255,255,0.9);" onclick="editCarousel(${carousel2.id})">
                                                <i class="material-icons-round" style="font-size: 1rem;">edit</i>
                                            </button>
                                            <button class="btn-icon delete" style="background: rgba(255,255,255,0.9);" onclick="deleteCarouselImage(${carousel2.id})">
                                                <i class="material-icons-round" style="font-size: 1rem;">delete</i>
                                            </button>
                                        </div>
                                        <div style="position: absolute; bottom: 1rem; left: 1rem; color: white;">
                                            <h4 style="font-weight: 600; margin-bottom: 0.5rem;">${carousel2.title}</h4>
                                            <p style="font-size: 0.875rem;">${carousel2.description}</p>
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getEnquiriesContent() {
            const newEnquiries = state.enquiries.filter(e => e.status === 'new');
            const readEnquiries = state.enquiries.filter(e => e.status === 'read');
            const followupEnquiries = state.enquiries.filter(e => e.status === 'followup');
            const convertedEnquiries = state.enquiries.filter(e => e.status === 'converted');
            
            return `
                <div class="enquiries-page">
                    <div class="search-filter">
                        <div class="search-box" style="flex: 1;">
                            <i class="material-icons-round search-icon">search</i>
                            <input type="text" class="search-input" id="enquirySearch" placeholder="Search enquiries..." onkeyup="searchEnquiries()">
                        </div>
                        <div class="filter-group">
                            <button class="filter-button active" onclick="filterEnquiries('all')">All (${state.enquiries.length})</button>
                            <button class="filter-button" onclick="filterEnquiries('new')">New (${newEnquiries.length})</button>
                            <button class="filter-button" onclick="filterEnquiries('read')">Read (${readEnquiries.length})</button>
                            <button class="filter-button" onclick="filterEnquiries('followup')">Follow-up (${followupEnquiries.length})</button>
                            <button class="filter-button" onclick="filterEnquiries('converted')">Converted (${convertedEnquiries.length})</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Enquiry Management</h2>
                            <p style="color: var(--gray-500);">Track and manage all enquiries from website and offline</p>
                        </div>
                        <button class="action-button" onclick="showModal('chatModal')">
                            <i class="material-icons-round">chat</i>
                            Live Chat
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Enquiries (${state.enquiries.length})</h3>
                            <div class="action-buttons">
                                <button class="btn-icon" onclick="exportEnquiries()">
                                    <i class="material-icons-round">download</i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="data-table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Enquiry #</th>
                                            <th>Name</th>
                                            <th>Contact</th>
                                            <th>Enquiry Type</th>
                                            <th>Source</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="enquiryTableBody">
                                        ${state.enquiries.map(enquiry => `
                                            <tr>
                                                <td style="font-weight: 600; color: var(--primary);">${enquiry.enquiryNumber}</td>
                                                <td>
                                                    <div style="font-weight: 600; color: var(--gray-900);">${enquiry.name}</div>
                                                    <div style="font-size: 0.75rem; color: var(--gray-500);">${enquiry.type}</div>
                                                </td>
                                                <td>
                                                    <div>${enquiry.email}</div>
                                                    <div style="font-size: 0.75rem; color: var(--gray-500);">${enquiry.phone}</div>
                                                </td>
                                                <td>${enquiry.type}</td>
                                                <td>
                                                    <span style="display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.25rem 0.75rem; background: #dbeafe; color: #1e40af; border-radius: 9999px; font-size: 0.75rem;">
                                                        <i class="material-icons-round" style="font-size: 0.875rem;">computer</i>
                                                        ${enquiry.source}
                                                    </span>
                                                </td>
                                                <td>${enquiry.date}</td>
                                                <td>
                                                    ${enquiry.status === 'new' ? '<span class="status-badge status-pending">New</span>' : ''}
                                                    ${enquiry.status === 'read' ? '<span class="status-badge" style="background: #e0e7ff; color: #3730a3;">Read</span>' : ''}
                                                    ${enquiry.status === 'followup' ? '<span class="status-badge" style="background: #fef3c7; color: #92400e;">Follow-up</span>' : ''}
                                                    ${enquiry.status === 'converted' ? '<span class="status-badge status-active">Converted</span>' : ''}
                                                </td>
                                                <td>
                                                    <div class="action-buttons">
                                                        <button class="btn-icon" onclick="viewEnquiryDetail(${enquiry.id})">
                                                            <i class="material-icons-round">visibility</i>
                                                        </button>
                                                        <button class="btn-icon" onclick="contactEnquiry(${enquiry.id})">
                                                            <i class="material-icons-round">mail</i>
                                                        </button>
                                                        <button class="btn-icon" onclick="callEnquiry(${enquiry.id})">
                                                            <i class="material-icons-round">phone</i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getChatContent() {
            return `
                <div class="chat-page">
                    <div style="margin-bottom: 1.5rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Live Chat Support</h2>
                        <p style="color: var(--gray-500);">Chat with website visitors and manage conversations</p>
                    </div>
                    
                    <div class="chat-container" style="height: 70vh;">
                        <div class="chat-sidebar">
                            <div class="chat-header">
                                <h3>Active Conversations (<span id="chatPageActiveCount">${state.activeChats.filter(c => c.status === 'online').length}</span>)</h3>
                            </div>
                            <div class="chat-users" id="chatPageUsers">
                                ${state.activeChats.map(chat => `
                                    <div class="chat-user" onclick="selectChatPage(${chat.id})">
                                        <div class="chat-avatar">${chat.name.split(' ').map(n => n[0]).join('')}</div>
                                        <div class="chat-user-info">
                                            <h4>${chat.name}</h4>
                                            <p>${chat.status === 'online' ? 'Online' : 'Away'} - ${chat.lastActivity}</p>
                                        </div>
                                        <div class="chat-status ${chat.status}"></div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="chat-main">
                            <div class="chat-header" style="border-bottom: 1px solid var(--gray-200);">
                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                    <div class="chat-avatar" id="chatPageAvatar">RS</div>
                                    <div>
                                        <h3 id="chatPageName">Select a conversation</h3>
                                        <p id="chatPageInfo" style="font-size: 0.75rem; color: var(--gray-500);">Click on a user to start chatting</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="chat-messages" id="chatPageMessages">
                                <!-- Chat messages loaded dynamically -->
                            </div>
                            
                            <div class="message-input">
                                <textarea id="chatPageInput" placeholder="Type your message..." disabled></textarea>
                                <button class="action-button" id="chatPageSend" style="align-self: flex-end;" disabled>
                                    <i class="material-icons-round">send</i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer" style="margin-top: 1rem; padding: 1rem; background: white; border-radius: var(--radius); border: 1px solid var(--gray-200);">
                        <button class="action-button secondary" id="chatPageEndBtn" disabled>
                            <i class="material-icons-round">call_end</i>
                            End Chat
                        </button>
                        <button class="action-button secondary" id="chatPageConvertBtn" disabled>
                            <i class="material-icons-round">forward_to_inbox</i>
                            Convert to Enquiry
                        </button>
                    </div>
                </div>
            `;
        }

        function getTCContent() {
            const activeTC = state.tcData.filter(tc => tc.status === 'active');
            const inactiveTC = state.tcData.filter(tc => tc.status === 'inactive');
            const academicYears = [...new Set(state.tcData.map(tc => tc.academicYear))];
            
            return `
                <div class="tc-page">
                    <div class="search-filter">
                        <div class="search-box" style="flex: 1;">
                            <i class="material-icons-round search-icon">search</i>
                            <input type="text" class="search-input" id="tcSearch" placeholder="Search TC data..." onkeyup="searchTCData()">
                        </div>
                        <div class="filter-group">
                            <select class="form-control" style="width: 200px;" id="tcYearFilter" onchange="filterTCByYear()">
                                <option value="">All Academic Years</option>
                                ${academicYears.map(year => `<option value="${year}">${year}</option>`).join('')}
                            </select>
                            <button class="action-button" onclick="addTCData()">
                                <i class="material-icons-round">add</i>
                                Add TC
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">TC Data Management</h2>
                        <p style="color: var(--gray-500);">Bulk upload and manage Transfer Certificate data</p>
                    </div>
                    
                    <div class="card" style="margin-bottom: 1.5rem;">
                        <div class="card-body">
                            <div style="display: flex; align-items: center; justify-content: center; gap: 2rem; padding: 2rem;">
                                <button class="action-button" onclick="uploadTCBulk()" style="padding: 1rem 2rem;">
                                    <i class="material-icons-round">upload</i>
                                    Bulk Upload Excel
                                </button>
                                <button class="action-button secondary" onclick="addTCData()" style="padding: 1rem 2rem;">
                                    <i class="material-icons-round">add</i>
                                    Add Manually
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Transfer Certificates (${state.tcData.length})</h3>
                            <div class="filter-group">
                                <button class="filter-button active" onclick="filterTCStatus('all')">All (${state.tcData.length})</button>
                                <button class="filter-button" onclick="filterTCStatus('active')">Active (${activeTC.length})</button>
                                <button class="filter-button" onclick="filterTCStatus('inactive')">Inactive (${inactiveTC.length})</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="data-table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Student Name</th>
                                            <th>Admission No.</th>
                                            <th>Academic Year</th>
                                            <th>Class</th>
                                            <th>Date of Issue</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tcTableBody">
                                        ${state.tcData.map(tc => `
                                            <tr>
                                                <td style="font-weight: 600; color: var(--gray-900);">${tc.studentName}</td>
                                                <td>${tc.admissionNo}</td>
                                                <td>${tc.academicYear}</td>
                                                <td>${tc.class}</td>
                                                <td>${tc.dateOfIssue}</td>
                                                <td>
                                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                        <label class="toggle-switch">
                                                            <input type="checkbox" ${tc.status === 'active' ? 'checked' : ''} onchange="toggleTCStatus(${tc.id}, this.checked)">
                                                            <span class="toggle-slider"></span>
                                                        </label>
                                                        <span style="font-size: 0.875rem;">${tc.status === 'active' ? 'Active' : 'Inactive'}</span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="action-buttons">
                                                        <button class="btn-icon" onclick="editTCData(${tc.id})">
                                                            <i class="material-icons-round">edit</i>
                                                        </button>
                                                        <button class="btn-icon" onclick="viewTCData(${tc.id})">
                                                            <i class="material-icons-round">visibility</i>
                                                        </button>
                                                        <button class="btn-icon delete" onclick="deleteTCData(${tc.id})">
                                                            <i class="material-icons-round">delete</i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getTimetableContent() {
            const activeTimetables = state.timetables.filter(t => t.status === 'active');
            const inactiveTimetables = state.timetables.filter(t => t.status === 'inactive');
            
            return `
                <div class="timetable-page">
                    <div class="search-filter">
                        <div class="search-box" style="flex: 1;">
                            <i class="material-icons-round search-icon">search</i>
                            <input type="text" class="search-input" id="timetableSearch" placeholder="Search timetables..." onkeyup="searchTimetables()">
                        </div>
                        <div class="filter-group">
                            <button class="action-button" onclick="addTimetable()">
                                <i class="material-icons-round">add</i>
                                Add Timetable
                            </button>
                            <button class="action-button secondary" onclick="uploadTimetable()">
                                <i class="material-icons-round">upload</i>
                                Upload Excel
                            </button>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Exam Timetable Management</h2>
                            <p style="color: var(--gray-500);">Upload and manage exam timetables in Excel format</p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Current Timetables (${state.timetables.length})</h3>
                            <div class="filter-group">
                                <button class="filter-button active" onclick="filterTimetableStatus('all')">All (${state.timetables.length})</button>
                                <button class="filter-button" onclick="filterTimetableStatus('active')">Active (${activeTimetables.length})</button>
                                <button class="filter-button" onclick="filterTimetableStatus('inactive')">Inactive (${inactiveTimetables.length})</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;" id="timetableContainer">
                                ${state.timetables.map(timetable => `
                                    <div class="card" style="margin: 0;">
                                        <div class="card-body">
                                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                                <div style="width: 48px; height: 48px; border-radius: var(--radius); background: linear-gradient(135deg, var(--warning), #fbbf24); display: flex; align-items: center; justify-content: center; color: white;">
                                                    <i class="material-icons-round">calendar_today</i>
                                                </div>
                                                <div>
                                                    <h4 style="font-weight: 600; color: var(--gray-900); margin-bottom: 0.25rem;">Class ${timetable.class} - ${timetable.term}</h4>
                                                    <p style="font-size: 0.875rem; color: var(--gray-500);">${timetable.dateRange}</p>
                                                </div>
                                            </div>
                                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                    <label class="toggle-switch">
                                                        <input type="checkbox" ${timetable.status === 'active' ? 'checked' : ''} onchange="toggleTimetableStatus(${timetable.id}, this.checked)">
                                                        <span class="toggle-slider"></span>
                                                    </label>
                                                    <span style="font-size: 0.875rem;">${timetable.status === 'active' ? 'Visible' : 'Hidden'}</span>
                                                </div>
                                                <span class="status-badge ${timetable.status === 'active' ? 'status-active' : 'status-closed'}">${timetable.status === 'active' ? 'Active' : 'Inactive'}</span>
                                            </div>
                                            <div class="action-buttons">
                                                <button class="btn-icon" style="flex: 1;" onclick="viewTimetable(${timetable.id})">
                                                    <i class="material-icons-round">visibility</i>
                                                    View
                                                </button>
                                                <button class="btn-icon edit" style="flex: 1;" onclick="editTimetable(${timetable.id})">
                                                    <i class="material-icons-round">edit</i>
                                                    Edit
                                                </button>
                                                <button class="btn-icon" style="flex: 1;" onclick="downloadTimetable(${timetable.id})">
                                                    <i class="material-icons-round">download</i>
                                                    Download
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getSecurityContent() {
            return `
                <div class="security-page">
                    <div style="margin-bottom: 1.5rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">Security Settings</h2>
                        <p style="color: var(--gray-500);">Manage website security, access controls, and restrictions</p>
                    </div>
                    
                    <div class="security-grid">
                        <div class="security-card">
                            <h4>Website Visibility Control</h4>
                            <div class="security-item">
                                <label>Master Website Switch</label>
                                <label class="toggle-switch">
                                    <input type="checkbox" ${state.securitySettings.websiteVisibility ? 'checked' : ''} onchange="toggleMasterWebsite(this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="security-item">
                                <label>Chat Feature</label>
                                <label class="toggle-switch">
                                    <input type="checkbox" ${state.securitySettings.chatEnabled ? 'checked' : ''} onchange="toggleChatFeature(this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="security-item">
                                <label>Website Tour</label>
                                <label class="toggle-switch">
                                    <input type="checkbox" ${state.securitySettings.websiteTour ? 'checked' : ''} onchange="toggleWebsiteTour(this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="security-card">
                            <h4>Banned IP Addresses</h4>
                            <div class="ip-list">
                                ${state.securitySettings.bannedIPs.map(ip => `
                                    <div class="ip-item">
                                        <span>${ip}</span>
                                        <button class="btn-icon delete" onclick="removeBannedIP('${ip}')">
                                            <i class="material-icons-round">delete</i>
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                                <input type="text" class="form-control" id="newBannedIP" placeholder="Add IP to ban">
                                <button class="action-button" onclick="addBannedIP()">Add</button>
                            </div>
                        </div>
                        
                        <div class="security-card">
                            <h4>Banned Countries</h4>
                            <div class="ip-list">
                                ${state.securitySettings.bannedCountries.map(country => `
                                    <div class="ip-item">
                                        <span>${country}</span>
                                        <button class="btn-icon delete" onclick="removeBannedCountry('${country}')">
                                            <i class="material-icons-round">delete</i>
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                                <input type="text" class="form-control" id="newBannedCountry" placeholder="Add country to ban">
                                <button class="action-button" onclick="addBannedCountry()">Add</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card" style="margin-top: 1.5rem;">
                        <div class="card-header">
                            <h3>Page Visibility Control</h3>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem;">
                                ${Object.entries(state.securitySettings.pageVisibility).map(([page, visible]) => `
                                    <div class="security-item">
                                        <label>${formatPageName(page)}</label>
                                        <label class="toggle-switch">
                                            <input type="checkbox" ${visible ? 'checked' : ''} onchange="togglePageVisibility('${page}', this.checked)">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getUsersContent() {
            return `
                <div class="users-page">
                    <div style="margin-bottom: 1.5rem;">
                        <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 0.25rem;">User Management</h2>
                        <p style="color: var(--gray-500);">Manage user accounts, roles, and permissions</p>
                    </div>
                    
                    <div class="role-grid">
                        ${state.users.map(user => `
                            <div class="role-card">
                                <div class="role-header">
                                    <div class="role-avatar">${user.name.split(' ').map(n => n[0]).join('')}</div>
                                    <div>
                                        <h4 style="font-weight: 600; color: var(--gray-900);">${user.name}</h4>
                                        <p style="font-size: 0.875rem; color: var(--gray-500);">${user.role.replace('-', ' ').toUpperCase()}</p>
                                    </div>
                                </div>
                                
                                <div class="role-permissions">
                                    ${Object.entries(user.permissions).map(([permission, allowed]) => `
                                        <div class="permission-item">
                                            <span style="font-size: 0.875rem; color: var(--gray-700);">${formatPermissionName(permission)}</span>
                                            <label class="toggle-switch">
                                                <input type="checkbox" ${allowed ? 'checked' : ''} onchange="toggleUserPermission(${user.id}, '${permission}', this.checked)">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    `).join('')}
                                </div>
                                
                                <div class="action-buttons" style="margin-top: 1rem;">
                                    <button class="btn-icon" onclick="editUser(${user.id})">
                                        <i class="material-icons-round">edit</i>
                                    </button>
                                    <button class="btn-icon delete" onclick="deleteUser(${user.id})">
                                        <i class="material-icons-round">delete</i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                        
                        <div class="role-card" style="display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="addNewUser()">
                            <div style="text-align: center;">
                                <i class="material-icons-round" style="font-size: 2.5rem; color: var(--gray-400); margin-bottom: 0.5rem;">person_add</i>
                                <h4 style="font-weight: 600; color: var(--gray-700);">Add New User</h4>
                                <p style="font-size: 0.875rem; color: var(--gray-500);">Create new user account</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getComingSoonContent() {
            return `
                <div style="text-align: center; padding: 4rem 1rem;">
                    <i class="material-icons-round" style="font-size: 4rem; color: var(--gray-300); margin-bottom: 1rem;">construction</i>
                    <h2 style="font-size: 1.5rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.5rem;">Coming Soon</h2>
                    <p style="color: var(--gray-500); max-width: 400px; margin: 0 auto;">This page is under development and will be available soon.</p>
                </div>
            `;
        }

        function initializePage(page) {
            switch(page) {
                case 'dashboard':
                    setupDashboardPage();
                    break;
                case 'careers':
                    setupCareersPage();
                    break;
                case 'applications':
                    setupApplicationsPage();
                    break;
                case 'blogs':
                    setupBlogsPage();
                    break;
                case 'carousels':
                    setupCarouselsPage();
                    break;
                case 'enquiries':
                    setupEnquiriesPage();
                    break;
                case 'chat':
                    setupChatPage();
                    break;
                case 'tc':
                    setupTCPage();
                    break;
                case 'timetable':
                    setupTimetablePage();
                    break;
                case 'security':
                    setupSecurityPage();
                    break;
                case 'users':
                    setupUsersPage();
                    break;
            }
        }

        function setupDashboardPage() {
            // Quick actions already have onclick handlers
        }

        function setupCareersPage() {
            // Search functionality
            const searchInput = document.getElementById('careerSearch');
            if (searchInput) {
                searchInput.addEventListener('input', searchCareers);
            }
        }

        function setupApplicationsPage() {
            // Search functionality
            const searchInput = document.getElementById('applicationSearch');
            if (searchInput) {
                searchInput.addEventListener('input', searchApplications);
            }
        }

        function setupBlogsPage() {
            // Blog page setup
        }

        function setupCarouselsPage() {
            // Carousels page setup
        }

        function setupEnquiriesPage() {
            // Search functionality
            const searchInput = document.getElementById('enquirySearch');
            if (searchInput) {
                searchInput.addEventListener('input', searchEnquiries);
            }
        }

        function setupChatPage() {
            // Setup chat page functionality
            const chatInput = document.getElementById('chatPageInput');
            const sendBtn = document.getElementById('chatPageSend');
            const endBtn = document.getElementById('chatPageEndBtn');
            const convertBtn = document.getElementById('chatPageConvertBtn');
            
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendChatMessagePage();
                    }
                });
            }
            
            if (sendBtn) {
                sendBtn.addEventListener('click', sendChatMessagePage);
            }
            
            if (endBtn) {
                endBtn.addEventListener('click', endChatPage);
            }
            
            if (convertBtn) {
                convertBtn.addEventListener('click', convertChatToEnquiryPage);
            }
        }

        function setupTCPage() {
            // Search functionality
            const searchInput = document.getElementById('tcSearch');
            if (searchInput) {
                searchInput.addEventListener('input', searchTCData);
            }
        }

        function setupTimetablePage() {
            // Search functionality
            const searchInput = document.getElementById('timetableSearch');
            if (searchInput) {
                searchInput.addEventListener('input', searchTimetables);
            }
        }

        function setupSecurityPage() {
            // Security page setup
        }

        function setupUsersPage() {
            // Users page setup
        }

        // Utility Functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="material-icons-round">${type === 'success' ? 'check' : type === 'error' ? 'error' : 'info'}</i>
                </div>
                <div class="toast-content">
                    <p>${message}</p>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="material-icons-round">close</i>
                </button>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 5000);
        }

        function formatPageName(page) {
            return page.split(/(?=[A-Z])/).map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        }

        function formatPermissionName(permission) {
            const names = {
                dashboard: 'Dashboard',
                careers: 'Career Management',
                applications: 'Applications',
                blogs: 'Blog Management',
                carousels: 'Carousel Management',
                enquiries: 'Enquiry Management',
                chat: 'Live Chat',
                tc: 'TC Data',
                timetable: 'Timetable',
                security: 'Security',
                users: 'User Management'
            };
            return names[permission] || permission;
        }

        // Career Functions
        function setPositionType(type) {
            document.getElementById('positionType').value = type;
            document.querySelectorAll('.filter-button[onclick*="setPositionType"]').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function saveCareer() {
            const title = document.getElementById('jobTitle').value;
            const department = document.getElementById('jobDepartment').value;
            const deadline = document.getElementById('jobDeadline').value;
            const description = document.getElementById('jobDescription').value;
            const requirements = document.getElementById('jobRequirements').value;
            const jobType = document.getElementById('jobType').value;
            const method = document.getElementById('applicationMethod').value;
            const status = document.getElementById('jobStatus').checked ? 'active' : 'inactive';
            const positionType = document.getElementById('positionType').value;
            
            if (!title || !department || !deadline || !description || !requirements) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            const newCareer = {
                id: state.careers.length + 1,
                title,
                department,
                postedDate: new Date().toISOString().split('T')[0],
                deadline,
                applications: 0,
                status,
                type: jobType,
                method,
                positionType,
                description,
                requirements
            };
            
            state.careers.unshift(newCareer);
            updateBadgeCounts();
            hideModal('newCareerModal');
            showToast('Career posting created successfully!', 'success');
            
            // Reset form
            document.getElementById('careerForm').reset();
            document.getElementById('positionType').value = 'academic';
            document.querySelectorAll('.filter-button[onclick*="setPositionType"]').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.filter-button[onclick="setPositionType(\'academic\')"]').classList.add('active');
            
            // Reload careers page if active
            if (state.currentPage === 'careers') {
                loadPage('careers');
            }
        }

        function viewCareerDetail(id) {
            const career = state.careers.find(c => c.id === id);
            if (!career) return;
            
            document.getElementById('detailJobTitle').textContent = career.title;
            document.getElementById('detailJobTitle').setAttribute('data-id', career.id);
            document.getElementById('detailDepartment').textContent = career.department;
            document.getElementById('detailPostedDate').textContent = career.postedDate;
            document.getElementById('detailDeadline').textContent = career.deadline;
            document.getElementById('detailApplications').textContent = career.applications;
            document.getElementById('detailJobType').textContent = career.type;
            document.getElementById('detailDescription').textContent = career.description;
            document.getElementById('detailRequirements').textContent = career.requirements;
            document.getElementById('detailJobStatus').checked = career.status === 'active';
            document.getElementById('detailStatusText').textContent = career.status === 'active' ? 'Active' : 'Closed';
            
            const positionTypeElement = document.getElementById('detailPositionType');
            positionTypeElement.textContent = career.positionType === 'academic' ? 'Academic' : 'Non-Academic';
            positionTypeElement.className = `tag ${career.positionType === 'academic' ? 'tag-academic' : 'tag-non-academic'}`;
            
            showModal('careerDetailModal');
        }

        function editCareer(id) {
            const career = state.careers.find(c => c.id === id);
            if (!career) return;
            
            // Populate form
            document.getElementById('jobTitle').value = career.title;
            document.getElementById('jobDepartment').value = career.department;
            document.getElementById('jobDeadline').value = career.deadline;
            document.getElementById('jobDescription').value = career.description;
            document.getElementById('jobRequirements').value = career.requirements;
            document.getElementById('jobType').value = career.type;
            document.getElementById('applicationMethod').value = career.method;
            document.getElementById('jobStatus').checked = career.status === 'active';
            document.getElementById('statusText').textContent = career.status === 'active' ? 'Active' : 'Closed';
            document.getElementById('positionType').value = career.positionType;
            
            // Update position type buttons
            document.querySelectorAll('.filter-button[onclick*="setPositionType"]').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.filter-button[onclick="setPositionType('${career.positionType}')"]`).classList.add('active');
            
            // Change modal title and button
            document.querySelector('#newCareerModal h3').textContent = 'Edit Career Posting';
            document.querySelector('#newCareerModal .action-button:last-child').textContent = 'Update Career';
            
            // Store career ID for update
            document.getElementById('jobTitle').setAttribute('data-id', career.id);
            
            showModal('newCareerModal');
        }

        function deleteCareer(id) {
            if (confirm('Are you sure you want to delete this career posting?')) {
                state.careers = state.careers.filter(c => c.id !== id);
                updateBadgeCounts();
                showToast('Career posting deleted successfully', 'success');
                loadPage('careers');
            }
        }

        function searchCareers() {
            const searchTerm = document.getElementById('careerSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#careerTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function filterCareers(filter) {
            const buttons = document.querySelectorAll('.careers-page .filter-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const rows = document.querySelectorAll('#careerTableBody tr');
            
            rows.forEach(row => {
                let show = false;
                const status = row.querySelector('.status-badge')?.textContent.toLowerCase();
                const positionType = row.querySelector('.tag')?.textContent.toLowerCase();
                
                switch(filter) {
                    case 'all':
                        show = true;
                        break;
                    case 'academic':
                        show = positionType === 'academic';
                        break;
                    case 'non-academic':
                        show = positionType === 'non-academic';
                        break;
                    case 'active':
                        show = status === 'active';
                        break;
                    case 'closed':
                        show = status === 'closed';
                        break;
                }
                
                row.style.display = show ? '' : 'none';
            });
        }

        function exportCareers() {
            showToast('Exporting careers data...', 'info');
            // In a real application, this would generate and download a CSV/Excel file
        }

        // Application Functions
        function viewApplicationDetail(id) {
            const app = state.applications.find(a => a.id === id);
            if (!app) return;
            
            document.getElementById('appName').textContent = app.name;
            document.getElementById('appEmail').textContent = app.email;
            document.getElementById('appPhone').textContent = app.phone;
            document.getElementById('appJob').textContent = app.job;
            document.getElementById('appDate').textContent = app.date;
            document.getElementById('appMethod').textContent = app.method.charAt(0).toUpperCase() + app.method.slice(1);
            document.getElementById('appStatus').textContent = app.status.charAt(0).toUpperCase() + app.status.slice(1);
            document.getElementById('appExperience').textContent = app.experience;
            document.getElementById('appQualification').textContent = app.qualification;
            document.getElementById('appCoverLetter').textContent = app.coverLetter;
            document.getElementById('applicationAvatar').textContent = app.name.split(' ').map(n => n[0]).join('');
            
            showModal('applicationDetailModal');
        }

        function editApplication(id) {
            const app = state.applications.find(a => a.id === id);
            if (!app) return;
            
            // In a real application, this would open an edit form
            showToast(`Editing application for ${app.name}`, 'info');
        }

        function contactApplicant(id) {
            const app = state.applications.find(a => a.id === id);
            if (!app) return;
            
            window.open(`mailto:${app.email}`, '_blank');
            showToast(`Opening email client for ${app.name}`, 'info');
        }

        function sendWhatsApp() {
            const phone = document.getElementById('appPhone').textContent;
            const message = `Hello ${document.getElementById('appName').textContent}, regarding your application for ${document.getElementById('appJob').textContent} at Modern School Kota`;
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/${phone.replace(/\D/g, '')}?text=${encodedMessage}`, '_blank');
            showToast('Opening WhatsApp...', 'info');
        }

        function sendEmail() {
            const email = document.getElementById('appEmail').textContent;
            const subject = `Application Update - ${document.getElementById('appJob').textContent}`;
            const body = `Dear ${document.getElementById('appName').textContent},\n\nRegarding your application for ${document.getElementById('appJob').textContent} at Modern School Kota.`;
            window.open(`mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');
        }

        function makeCall() {
            const phone = document.getElementById('appPhone').textContent;
            window.open(`tel:${phone}`, '_blank');
        }

        function printApplication() {
            window.print();
        }

        function searchApplications() {
            const searchTerm = document.getElementById('applicationSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#applicationTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function filterApplications(filter) {
            const buttons = document.querySelectorAll('.applications-page .filter-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const rows = document.querySelectorAll('#applicationTableBody tr');
            
            rows.forEach(row => {
                let show = false;
                const status = row.querySelector('.status-badge')?.textContent.toLowerCase();
                const method = row.querySelector('span')?.textContent.toLowerCase();
                
                switch(filter) {
                    case 'all':
                        show = true;
                        break;
                    case 'online':
                        show = method === 'online';
                        break;
                    case 'offline':
                        show = method === 'offline';
                        break;
                    case 'pending':
                        show = status === 'pending';
                        break;
                    case 'shortlisted':
                        show = status === 'shortlisted';
                        break;
                }
                
                row.style.display = show ? '' : 'none';
            });
        }

        function exportApplications() {
            showToast('Exporting applications data...', 'info');
        }

        function viewApplicationsForJob(jobId) {
            const career = state.careers.find(c => c.id === jobId);
            if (!career) return;
            
            navigateTo('applications');
            showToast(`Showing applications for: ${career.title}`, 'info');
            
            // Filter applications for this job
            setTimeout(() => {
                const jobApplications = state.applications.filter(a => a.job === career.title);
                document.getElementById('applicationSearch').value = career.title;
                searchApplications();
            }, 500);
        }

        // Blog Functions
        function createNewBlog() {
            document.getElementById('blogModalTitle').textContent = 'Create New Blog Post';
            document.getElementById('blogTitle').value = '';
            document.getElementById('blogCategory').value = 'academics';
            document.getElementById('blogContent').value = '';
            document.getElementById('blogVisibility').checked = true;
            document.getElementById('blogPublishDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('visibilityText').textContent = 'Visible on Website';
            
            showModal('blogEditModal');
        }

        function editBlogPost(id) {
            const blog = state.blogs.find(b => b.id === id);
            if (!blog) return;
            
            document.getElementById('blogModalTitle').textContent = 'Edit Blog Post';
            document.getElementById('blogTitle').value = blog.title;
            document.getElementById('blogCategory').value = blog.category;
            document.getElementById('blogContent').value = blog.content;
            document.getElementById('blogVisibility').checked = blog.visible;
            document.getElementById('blogPublishDate').value = blog.publishDate;
            document.getElementById('visibilityText').textContent = blog.visible ? 'Visible on Website' : 'Hidden';
            
            // Store blog ID for update
            document.getElementById('blogTitle').setAttribute('data-id', blog.id);
            
            showModal('blogEditModal');
        }

        function saveBlog() {
            const title = document.getElementById('blogTitle').value;
            const category = document.getElementById('blogCategory').value;
            const content = document.getElementById('blogContent').value;
            const visible = document.getElementById('blogVisibility').checked;
            const publishDate = document.getElementById('blogPublishDate').value;
            const blogId = document.getElementById('blogTitle').getAttribute('data-id');
            
            if (!title || !content) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            if (blogId) {
                // Update existing blog
                const blog = state.blogs.find(b => b.id === parseInt(blogId));
                if (blog) {
                    blog.title = title;
                    blog.category = category;
                    blog.content = content;
                    blog.visible = visible;
                    blog.publishDate = publishDate;
                    showToast('Blog post updated successfully!', 'success');
                }
            } else {
                // Create new blog
                const newBlog = {
                    id: state.blogs.length + 1,
                    title,
                    category,
                    content,
                    publishDate,
                    visible,
                    image: state.blogs.length % 2 === 0 ? 'gradient-1' : 'gradient-2'
                };
                state.blogs.unshift(newBlog);
                showToast('Blog post created successfully!', 'success');
            }
            
            hideModal('blogEditModal');
            loadPage('blogs');
        }

        function toggleBlogVisibility(id, visible) {
            const blog = state.blogs.find(b => b.id === id);
            if (blog) {
                blog.visible = visible;
                showToast(`Blog ${visible ? 'published' : 'hidden'}`, 'success');
            }
        }

        function deleteBlog(id) {
            if (confirm('Are you sure you want to delete this blog post?')) {
                state.blogs = state.blogs.filter(b => b.id !== id);
                showToast('Blog post deleted successfully', 'success');
                loadPage('blogs');
            }
        }

        function uploadBlogImage() {
            showToast('Image upload functionality would be implemented here', 'info');
        }

        // Carousel Functions
        function addCarouselImage(type) {
            document.getElementById('carouselRatioText').textContent = type === 'carousel1' ? '2:1 ratio required' : '1:2 ratio required';
            document.getElementById('carouselTitle').value = '';
            document.getElementById('carouselDescription').value = '';
            document.getElementById('carouselButtonText').value = 'Learn More';
            document.getElementById('carouselButtonLink').value = '/about';
            document.getElementById('carouselVisibility').checked = true;
            
            // Store carousel type for saving
            document.getElementById('carouselTitle').setAttribute('data-type', type);
            
            showModal('carouselEditModal');
        }

        function editCarousel(id) {
            const carousel = state.carousels.find(c => c.id === id);
            if (!carousel) return;
            
            document.getElementById('carouselRatioText').textContent = carousel.ratio === '2:1' ? '2:1 ratio required' : '1:2 ratio required';
            document.getElementById('carouselTitle').value = carousel.title;
            document.getElementById('carouselDescription').value = carousel.description;
            document.getElementById('carouselButtonText').value = carousel.buttonText;
            document.getElementById('carouselButtonLink').value = carousel.buttonLink;
            document.getElementById('carouselVisibility').checked = carousel.visible;
            
            // Store carousel ID for update
            document.getElementById('carouselTitle').setAttribute('data-id', carousel.id);
            
            showModal('carouselEditModal');
        }

        function saveCarousel() {
            const title = document.getElementById('carouselTitle').value;
            const description = document.getElementById('carouselDescription').value;
            const buttonText = document.getElementById('carouselButtonText').value;
            const buttonLink = document.getElementById('carouselButtonLink').value;
            const visible = document.getElementById('carouselVisibility').checked;
            const carouselId = document.getElementById('carouselTitle').getAttribute('data-id');
            const type = document.getElementById('carouselTitle').getAttribute('data-type');
            
            if (!title) {
                showToast('Please enter a title', 'error');
                return;
            }
            
            if (carouselId) {
                // Update existing carousel
                const carousel = state.carousels.find(c => c.id === parseInt(carouselId));
                if (carousel) {
                    carousel.title = title;
                    carousel.description = description;
                    carousel.buttonText = buttonText;
                    carousel.buttonLink = buttonLink;
                    carousel.visible = visible;
                    showToast('Carousel updated successfully!', 'success');
                }
            } else {
                // Create new carousel
                const newCarousel = {
                    id: state.carousels.length + 1,
                    type,
                    ratio: type === 'carousel1' ? '2:1' : '1:2',
                    title,
                    description,
                    buttonText,
                    buttonLink,
                    visible
                };
                state.carousels.push(newCarousel);
                showToast('Carousel added successfully!', 'success');
            }
            
            hideModal('carouselEditModal');
            loadPage('carousels');
        }

        function deleteCarouselImage(id) {
            if (confirm('Are you sure you want to delete this carousel image?')) {
                state.carousels = state.carousels.filter(c => c.id !== id);
                showToast('Carousel image deleted successfully', 'success');
                loadPage('carousels');
            }
        }

        function uploadCarouselImage() {
            showToast('Image upload functionality would be implemented here', 'info');
        }

        // Enquiry Functions
        function viewEnquiryDetail(id) {
            const enquiry = state.enquiries.find(e => e.id === id);
            if (!enquiry) return;
            
            document.getElementById('enquiryNumber').textContent = `#${enquiry.enquiryNumber}`;
            document.getElementById('enquiryName').textContent = enquiry.name;
            document.getElementById('enquiryEmail').textContent = enquiry.email;
            document.getElementById('enquiryPhone').textContent = enquiry.phone;
            document.getElementById('enquiryType').textContent = enquiry.type;
            document.getElementById('enquiryDate').textContent = enquiry.date;
            document.getElementById('enquirySource').textContent = enquiry.source;
            document.getElementById('enquiryStatus').textContent = enquiry.status.charAt(0).toUpperCase() + enquiry.status.slice(1);
            document.getElementById('enquiryClass').textContent = enquiry.class;
            document.getElementById('enquiryTime').textContent = enquiry.contactTime;
            document.getElementById('enquiryMessage').textContent = enquiry.message;
            document.getElementById('enquiryNotes').value = enquiry.notes;
            document.getElementById('enquiryAvatar').textContent = enquiry.name.split(' ').map(n => n[0]).join('');
            
            // Store enquiry ID for actions
            document.getElementById('enquiryName').setAttribute('data-id', enquiry.id);
            
            showModal('enquiryDetailModal');
        }

        function markAsRead() {
            const enquiryId = document.getElementById('enquiryName').getAttribute('data-id');
            const enquiry = state.enquiries.find(e => e.id === parseInt(enquiryId));
            if (enquiry) {
                enquiry.status = 'read';
                showToast('Enquiry marked as read', 'success');
                hideModal('enquiryDetailModal');
                loadPage('enquiries');
                updateBadgeCounts();
            }
        }

        function markAsUnread() {
            const enquiryId = document.getElementById('enquiryName').getAttribute('data-id');
            const enquiry = state.enquiries.find(e => e.id === parseInt(enquiryId));
            if (enquiry) {
                enquiry.status = 'new';
                showToast('Enquiry marked as unread', 'success');
                hideModal('enquiryDetailModal');
                loadPage('enquiries');
                updateBadgeCounts();
            }
        }

        function moveToFollowup() {
            const enquiryId = document.getElementById('enquiryName').getAttribute('data-id');
            const enquiry = state.enquiries.find(e => e.id === parseInt(enquiryId));
            if (enquiry) {
                enquiry.status = 'followup';
                showToast('Enquiry moved to follow-up', 'success');
                hideModal('enquiryDetailModal');
                loadPage('enquiries');
                updateBadgeCounts();
            }
        }

        function moveToConverted() {
            const enquiryId = document.getElementById('enquiryName').getAttribute('data-id');
            const enquiry = state.enquiries.find(e => e.id === parseInt(enquiryId));
            if (enquiry) {
                enquiry.status = 'converted';
                showToast('Enquiry marked as converted', 'success');
                hideModal('enquiryDetailModal');
                loadPage('enquiries');
                updateBadgeCounts();
            }
        }

        function saveEnquiryNotes() {
            const enquiryId = document.getElementById('enquiryName').getAttribute('data-id');
            const notes = document.getElementById('enquiryNotes').value;
            const enquiry = state.enquiries.find(e => e.id === parseInt(enquiryId));
            
            if (enquiry) {
                enquiry.notes = notes;
                showToast('Notes saved successfully', 'success');
            }
        }

        function enquiryWhatsApp() {
            const phone = document.getElementById('enquiryPhone').textContent;
            const name = document.getElementById('enquiryName').textContent;
            const message = `Hello ${name}, regarding your enquiry with Modern School Kota`;
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/${phone.replace(/\D/g, '')}?text=${encodedMessage}`, '_blank');
            showToast('Opening WhatsApp...', 'info');
        }

        function enquiryEmail() {
            const email = document.getElementById('enquiryEmail').textContent;
            const name = document.getElementById('enquiryName').textContent;
            const subject = `Regarding your enquiry - Modern School Kota`;
            const body = `Dear ${name},\n\nThank you for your enquiry with Modern School Kota.`;
            window.open(`mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');
        }

        function enquiryCall() {
            const phone = document.getElementById('enquiryPhone').textContent;
            window.open(`tel:${phone}`, '_blank');
        }

        function contactEnquiry(id) {
            const enquiry = state.enquiries.find(e => e.id === id);
            if (enquiry) {
                window.open(`mailto:${enquiry.email}`, '_blank');
            }
        }

        function callEnquiry(id) {
            const enquiry = state.enquiries.find(e => e.id === id);
            if (enquiry) {
                window.open(`tel:${enquiry.phone}`, '_blank');
            }
        }

        function searchEnquiries() {
            const searchTerm = document.getElementById('enquirySearch').value.toLowerCase();
            const rows = document.querySelectorAll('#enquiryTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function filterEnquiries(filter) {
            const buttons = document.querySelectorAll('.enquiries-page .filter-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const rows = document.querySelectorAll('#enquiryTableBody tr');
            
            rows.forEach(row => {
                let show = false;
                const status = row.querySelector('.status-badge')?.textContent.toLowerCase();
                
                switch(filter) {
                    case 'all':
                        show = true;
                        break;
                    case 'new':
                        show = status === 'new';
                        break;
                    case 'read':
                        show = status === 'read';
                        break;
                    case 'followup':
                        show = status === 'follow-up';
                        break;
                    case 'converted':
                        show = status === 'converted';
                        break;
                }
                
                row.style.display = show ? '' : 'none';
            });
        }

        function exportEnquiries() {
            showToast('Exporting enquiries data...', 'info');
        }

        // Chat Functions
        function selectChatPage(id) {
            const chat = state.activeChats.find(c => c.id === id);
            if (!chat) return;
            
            state.currentChat = chat;
            
            document.getElementById('chatPageName').textContent = chat.name;
            document.getElementById('chatPageInfo').textContent = `${chat.email} | ${chat.phone}`;
            document.getElementById('chatPageAvatar').textContent = chat.name.split(' ').map(n => n[0]).join('');
            
            const messagesContainer = document.getElementById('chatPageMessages');
            messagesContainer.innerHTML = chat.messages.map(msg => `
                <div class="message ${msg.type === 'sent' ? 'sent' : 'received'}">
                    ${msg.text}
                    <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 0.25rem;">${msg.time}</div>
                </div>
            `).join('');
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            document.getElementById('chatPageInput').disabled = false;
            document.getElementById('chatPageSend').disabled = false;
            document.getElementById('chatPageEndBtn').disabled = false;
            document.getElementById('chatPageConvertBtn').disabled = false;
            
            // Highlight active user
            document.querySelectorAll('#chatPageUsers .chat-user').forEach(user => {
                user.classList.remove('active');
                if (user.querySelector('.chat-avatar').textContent === chat.name.split(' ').map(n => n[0]).join('')) {
                    user.classList.add('active');
                }
            });
        }

        function sendChatMessagePage() {
            const input = document.getElementById('chatPageInput');
            const message = input.value.trim();
            
            if (!message || !state.currentChat) return;
            
            const now = new Date();
            const time = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            state.currentChat.messages.push({
                type: 'sent',
                text: message,
                time: time
            });
            
            state.currentChat.lastActivity = 'Just now';
            
            // Add to messages display
            const messagesContainer = document.getElementById('chatPageMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message sent';
            messageDiv.innerHTML = `
                ${message}
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 0.25rem;">${time}</div>
            `;
            messagesContainer.appendChild(messageDiv);
            
            // Clear input and scroll to bottom
            input.value = '';
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Simulate auto-reply after 1 second
            setTimeout(() => {
                const replies = [
                    "Thank you for your message. How can I assist you further?",
                    "I understand. Let me check that for you.",
                    "Is there anything else you would like to know?",
                    "Thank you for contacting Modern School Kota."
                ];
                const reply = replies[Math.floor(Math.random() * replies.length)];
                
                state.currentChat.messages.push({
                    type: 'received',
                    text: reply,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                });
                
                const replyDiv = document.createElement('div');
                replyDiv.className = 'message received';
                replyDiv.innerHTML = `
                    ${reply}
                    <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 0.25rem;">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                `;
                messagesContainer.appendChild(replyDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
                // Update last activity
                state.currentChat.lastActivity = 'Just now';
                
                // Update chat users list
                loadPage('chat');
            }, 1000);
        }

        function endChatPage() {
            if (!state.currentChat) return;
            
            if (confirm('Are you sure you want to end this chat?')) {
                state.activeChats = state.activeChats.filter(c => c.id !== state.currentChat.id);
                state.currentChat = null;
                
                // Reset chat interface
                document.getElementById('chatPageName').textContent = 'Select a conversation';
                document.getElementById('chatPageInfo').textContent = 'Click on a user to start chatting';
                document.getElementById('chatPageAvatar').textContent = 'RS';
                document.getElementById('chatPageMessages').innerHTML = '';
                document.getElementById('chatPageInput').value = '';
                document.getElementById('chatPageInput').disabled = true;
                document.getElementById('chatPageSend').disabled = true;
                document.getElementById('chatPageEndBtn').disabled = true;
                document.getElementById('chatPageConvertBtn').disabled = true;
                
                showToast('Chat ended successfully', 'success');
                loadPage('chat');
                updateBadgeCounts();
            }
        }

        function convertChatToEnquiryPage() {
            if (!state.currentChat) return;
            
            const enquiryNumber = `ENQ${String(state.enquiries.length + 1).padStart(3, '0')}`;
            const newEnquiry = {
                id: state.enquiries.length + 1,
                name: state.currentChat.name,
                email: state.currentChat.email,
                phone: state.currentChat.phone,
                type: 'General',
                date: new Date().toISOString().split('T')[0],
                source: 'Chat',
                status: 'new',
                class: 'Not specified',
                contactTime: 'Any time',
                message: `Converted from chat conversation. Last message: "${state.currentChat.messages[state.currentChat.messages.length - 1].text}"`,
                notes: '',
                enquiryNumber
            };
            
            state.enquiries.unshift(newEnquiry);
            showToast('Chat converted to enquiry successfully', 'success');
            updateBadgeCounts();
            
            // End the chat after conversion
            endChatPage();
        }

        // TC Data Functions
        function addTCData() {
            document.getElementById('tcModalTitle').textContent = 'Add TC Data';
            
            const today = new Date().toISOString().split('T')[0];
            const formHTML = `
                <form id="tcForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Student Name</label>
                            <input type="text" class="form-control" id="tcStudentName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Admission Number</label>
                            <input type="text" class="form-control" id="tcAdmissionNo" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Academic Year</label>
                            <select class="form-control" id="tcAcademicYear" required>
                                <option value="2023-2024">2023-2024</option>
                                <option value="2022-2023">2022-2023</option>
                                <option value="2021-2022">2021-2022</option>
                                <option value="2020-2021">2020-2021</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Class</label>
                            <select class="form-control" id="tcClass" required>
                                <option value="I">Class I</option>
                                <option value="II">Class II</option>
                                <option value="III">Class III</option>
                                <option value="IV">Class IV</option>
                                <option value="V">Class V</option>
                                <option value="VI">Class VI</option>
                                <option value="VII">Class VII</option>
                                <option value="VIII">Class VIII</option>
                                <option value="IX">Class IX</option>
                                <option value="X">Class X</option>
                                <option value="XI">Class XI</option>
                                <option value="XII">Class XII</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Date of Issue</label>
                            <input type="date" class="form-control" id="tcDateOfIssue" value="${today}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="tcStatus" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="tcStatusText" style="font-size: 0.875rem; color: var(--gray-700);">Active</span>
                            </div>
                        </div>
                    </div>
                </form>
            `;
            
            document.getElementById('tcDataForm').innerHTML = formHTML;
            
            // Add event listener for status toggle
            setTimeout(() => {
                const statusToggle = document.getElementById('tcStatus');
                if (statusToggle) {
                    statusToggle.addEventListener('change', function() {
                        document.getElementById('tcStatusText').textContent = this.checked ? 'Active' : 'Inactive';
                    });
                }
            }, 100);
            
            showModal('tcDataModal');
        }

        function editTCData(id) {
            const tc = state.tcData.find(t => t.id === id);
            if (!tc) return;
            
            document.getElementById('tcModalTitle').textContent = 'Edit TC Data';
            
            const formHTML = `
                <form id="tcForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Student Name</label>
                            <input type="text" class="form-control" id="tcStudentName" value="${tc.studentName}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Admission Number</label>
                            <input type="text" class="form-control" id="tcAdmissionNo" value="${tc.admissionNo}" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Academic Year</label>
                            <select class="form-control" id="tcAcademicYear" required>
                                <option value="2023-2024" ${tc.academicYear === '2023-2024' ? 'selected' : ''}>2023-2024</option>
                                <option value="2022-2023" ${tc.academicYear === '2022-2023' ? 'selected' : ''}>2022-2023</option>
                                <option value="2021-2022" ${tc.academicYear === '2021-2022' ? 'selected' : ''}>2021-2022</option>
                                <option value="2020-2021" ${tc.academicYear === '2020-2021' ? 'selected' : ''}>2020-2021</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Class</label>
                            <select class="form-control" id="tcClass" required>
                                <option value="I" ${tc.class === 'I' ? 'selected' : ''}>Class I</option>
                                <option value="II" ${tc.class === 'II' ? 'selected' : ''}>Class II</option>
                                <option value="III" ${tc.class === 'III' ? 'selected' : ''}>Class III</option>
                                <option value="IV" ${tc.class === 'IV' ? 'selected' : ''}>Class IV</option>
                                <option value="V" ${tc.class === 'V' ? 'selected' : ''}>Class V</option>
                                <option value="VI" ${tc.class === 'VI' ? 'selected' : ''}>Class VI</option>
                                <option value="VII" ${tc.class === 'VII' ? 'selected' : ''}>Class VII</option>
                                <option value="VIII" ${tc.class === 'VIII' ? 'selected' : ''}>Class VIII</option>
                                <option value="IX" ${tc.class === 'IX' ? 'selected' : ''}>Class IX</option>
                                <option value="X" ${tc.class === 'X' ? 'selected' : ''}>Class X</option>
                                <option value="XI" ${tc.class === 'XI' ? 'selected' : ''}>Class XI</option>
                                <option value="XII" ${tc.class === 'XII' ? 'selected' : ''}>Class XII</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Date of Issue</label>
                            <input type="date" class="form-control" id="tcDateOfIssue" value="${tc.dateOfIssue}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="tcStatus" ${tc.status === 'active' ? 'checked' : ''}>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="tcStatusText" style="font-size: 0.875rem; color: var(--gray-700);">${tc.status === 'active' ? 'Active' : 'Inactive'}</span>
                            </div>
                        </div>
                    </div>
                </form>
            `;
            
            document.getElementById('tcDataForm').innerHTML = formHTML;
            
            // Store TC ID for update
            document.getElementById('tcDataForm').setAttribute('data-id', tc.id);
            
            // Add event listener for status toggle
            setTimeout(() => {
                const statusToggle = document.getElementById('tcStatus');
                if (statusToggle) {
                    statusToggle.addEventListener('change', function() {
                        document.getElementById('tcStatusText').textContent = this.checked ? 'Active' : 'Inactive';
                    });
                }
            }, 100);
            
            showModal('tcDataModal');
        }

        function saveTCData() {
            const studentName = document.getElementById('tcStudentName').value;
            const admissionNo = document.getElementById('tcAdmissionNo').value;
            const academicYear = document.getElementById('tcAcademicYear').value;
            const tcClass = document.getElementById('tcClass').value;
            const dateOfIssue = document.getElementById('tcDateOfIssue').value;
            const status = document.getElementById('tcStatus').checked ? 'active' : 'inactive';
            const tcId = document.getElementById('tcDataForm').getAttribute('data-id');
            
            if (!studentName || !admissionNo || !academicYear || !tcClass || !dateOfIssue) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            if (tcId) {
                // Update existing TC
                const tc = state.tcData.find(t => t.id === parseInt(tcId));
                if (tc) {
                    tc.studentName = studentName;
                    tc.admissionNo = admissionNo;
                    tc.academicYear = academicYear;
                    tc.class = tcClass;
                    tc.dateOfIssue = dateOfIssue;
                    tc.status = status;
                    showToast('TC data updated successfully!', 'success');
                }
            } else {
                // Create new TC
                const newTC = {
                    id: state.tcData.length + 1,
                    studentName,
                    admissionNo,
                    academicYear,
                    class: tcClass,
                    dateOfIssue,
                    status
                };
                state.tcData.push(newTC);
                showToast('TC data added successfully!', 'success');
            }
            
            hideModal('tcDataModal');
            loadPage('tc');
        }

        function viewTCData(id) {
            const tc = state.tcData.find(t => t.id === id);
            if (!tc) return;
            
            showToast(`Viewing TC data for ${tc.studentName}`, 'info');
        }

        function deleteTCData(id) {
            if (confirm('Are you sure you want to delete this TC data?')) {
                state.tcData = state.tcData.filter(t => t.id !== id);
                showToast('TC data deleted successfully', 'success');
                loadPage('tc');
            }
        }

        function toggleTCStatus(id, active) {
            const tc = state.tcData.find(t => t.id === id);
            if (tc) {
                tc.status = active ? 'active' : 'inactive';
                showToast(`TC status ${active ? 'activated' : 'deactivated'}`, 'success');
            }
        }

        function searchTCData() {
            const searchTerm = document.getElementById('tcSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#tcTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function filterTCByYear() {
            const year = document.getElementById('tcYearFilter').value;
            const rows = document.querySelectorAll('#tcTableBody tr');
            
            rows.forEach(row => {
                const yearCell = row.cells[2]; // Academic Year column
                if (!year || year === '') {
                    row.style.display = '';
                } else {
                    row.style.display = yearCell.textContent === year ? '' : 'none';
                }
            });
        }

        function filterTCStatus(status) {
            const buttons = document.querySelectorAll('.tc-page .filter-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const rows = document.querySelectorAll('#tcTableBody tr');
            
            rows.forEach(row => {
                let show = false;
                const statusText = row.querySelector('span')?.textContent.toLowerCase();
                
                switch(status) {
                    case 'all':
                        show = true;
                        break;
                    case 'active':
                        show = statusText === 'active';
                        break;
                    case 'inactive':
                        show = statusText === 'inactive';
                        break;
                }
                
                row.style.display = show ? '' : 'none';
            });
        }

        function uploadTCBulk() {
            showToast('TC bulk upload functionality would be implemented here', 'info');
        }

        // Timetable Functions
        function addTimetable() {
            document.getElementById('timetableModalTitle').textContent = 'Add Timetable';
            
            const today = new Date();
            const nextMonth = new Date(today.getFullYear(), today.getMonth() + 1, 1);
            const nextMonthStr = nextMonth.toISOString().split('T')[0];
            
            const formHTML = `
                <form id="timetableForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Class</label>
                            <select class="form-control" id="timetableClass" required>
                                <option value="">Select Class</option>
                                <option value="I">Class I</option>
                                <option value="II">Class II</option>
                                <option value="III">Class III</option>
                                <option value="IV">Class IV</option>
                                <option value="V">Class V</option>
                                <option value="VI">Class VI</option>
                                <option value="VII">Class VII</option>
                                <option value="VIII">Class VIII</option>
                                <option value="IX">Class IX</option>
                                <option value="X">Class X</option>
                                <option value="XI">Class XI</option>
                                <option value="XII">Class XII</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Term</label>
                            <select class="form-control" id="timetableTerm" required>
                                <option value="Term 1">Term 1</option>
                                <option value="Term 2">Term 2</option>
                                <option value="Term 3">Term 3</option>
                                <option value="Final">Final</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Start Date</label>
                            <input type="date" class="form-control" id="timetableStartDate" value="${nextMonthStr}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">End Date</label>
                            <input type="date" class="form-control" id="timetableEndDate" value="${nextMonthStr}" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Timetable Details (JSON format)</label>
                        <textarea class="form-control" id="timetableDetails" rows="6" placeholder='[{"day": "Monday", "time": "9:00-10:00", "subject": "Mathematics"}, {"day": "Monday", "time": "10:00-11:00", "subject": "Science"}]'></textarea>
                        <small style="color: var(--gray-500);">Enter timetable in JSON format or leave empty for default</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <label class="toggle-switch">
                                <input type="checkbox" id="timetableStatus" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span id="timetableStatusText" style="font-size: 0.875rem; color: var(--gray-700);">Active</span>
                        </div>
                    </div>
                </form>
            `;
            
            document.getElementById('timetableForm').innerHTML = formHTML;
            
            // Add event listener for status toggle
            setTimeout(() => {
                const statusToggle = document.getElementById('timetableStatus');
                if (statusToggle) {
                    statusToggle.addEventListener('change', function() {
                        document.getElementById('timetableStatusText').textContent = this.checked ? 'Active' : 'Inactive';
                    });
                }
            }, 100);
            
            showModal('timetableModal');
        }

        function editTimetable(id) {
            const timetable = state.timetables.find(t => t.id === id);
            if (!timetable) return;
            
            document.getElementById('timetableModalTitle').textContent = 'Edit Timetable';
            
            // Parse date range
            const dateParts = timetable.dateRange.split(' ');
            const startDate = dateParts[0]; // "Nov 1-15" format - simplified
            
            const formHTML = `
                <form id="timetableForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Class</label>
                            <select class="form-control" id="timetableClass" required>
                                <option value="I" ${timetable.class === 'I' ? 'selected' : ''}>Class I</option>
                                <option value="II" ${timetable.class === 'II' ? 'selected' : ''}>Class II</option>
                                <option value="III" ${timetable.class === 'III' ? 'selected' : ''}>Class III</option>
                                <option value="IV" ${timetable.class === 'IV' ? 'selected' : ''}>Class IV</option>
                                <option value="V" ${timetable.class === 'V' ? 'selected' : ''}>Class V</option>
                                <option value="VI" ${timetable.class === 'VI' ? 'selected' : ''}>Class VI</option>
                                <option value="VII" ${timetable.class === 'VII' ? 'selected' : ''}>Class VII</option>
                                <option value="VIII" ${timetable.class === 'VIII' ? 'selected' : ''}>Class VIII</option>
                                <option value="IX" ${timetable.class === 'IX' ? 'selected' : ''}>Class IX</option>
                                <option value="X" ${timetable.class === 'X' ? 'selected' : ''}>Class X</option>
                                <option value="XI" ${timetable.class === 'XI' ? 'selected' : ''}>Class XI</option>
                                <option value="XII" ${timetable.class === 'XII' ? 'selected' : ''}>Class XII</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Term</label>
                            <select class="form-control" id="timetableTerm" required>
                                <option value="Term 1" ${timetable.term === 'Term 1' ? 'selected' : ''}>Term 1</option>
                                <option value="Term 2" ${timetable.term === 'Term 2' ? 'selected' : ''}>Term 2</option>
                                <option value="Term 3" ${timetable.term === 'Term 3' ? 'selected' : ''}>Term 3</option>
                                <option value="Final" ${timetable.term === 'Final' ? 'selected' : ''}>Final</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Start Date</label>
                            <input type="date" class="form-control" id="timetableStartDate" value="2023-11-01" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">End Date</label>
                            <input type="date" class="form-control" id="timetableEndDate" value="2023-11-15" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Timetable Details (JSON format)</label>
                        <textarea class="form-control" id="timetableDetails" rows="6">${JSON.stringify(timetable.subjects || [], null, 2)}</textarea>
                        <small style="color: var(--gray-500);">Enter timetable in JSON format</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <label class="toggle-switch">
                                <input type="checkbox" id="timetableStatus" ${timetable.status === 'active' ? 'checked' : ''}>
                                <span class="toggle-slider"></span>
                            </label>
                            <span id="timetableStatusText" style="font-size: 0.875rem; color: var(--gray-700);">${timetable.status === 'active' ? 'Active' : 'Inactive'}</span>
                        </div>
                    </div>
                </form>
            `;
            
            document.getElementById('timetableForm').innerHTML = formHTML;
            
            // Store timetable ID for update
            document.getElementById('timetableForm').setAttribute('data-id', timetable.id);
            
            // Add event listener for status toggle
            setTimeout(() => {
                const statusToggle = document.getElementById('timetableStatus');
                if (statusToggle) {
                    statusToggle.addEventListener('change', function() {
                        document.getElementById('timetableStatusText').textContent = this.checked ? 'Active' : 'Inactive';
                    });
                }
            }, 100);
            
            showModal('timetableModal');
        }

        function saveTimetable() {
            const timetableClass = document.getElementById('timetableClass').value;
            const term = document.getElementById('timetableTerm').value;
            const startDate = document.getElementById('timetableStartDate').value;
            const endDate = document.getElementById('timetableEndDate').value;
            const details = document.getElementById('timetableDetails').value;
            const status = document.getElementById('timetableStatus').checked ? 'active' : 'inactive';
            const timetableId = document.getElementById('timetableForm').getAttribute('data-id');
            
            if (!timetableClass || !term || !startDate || !endDate) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            // Format date range
            const start = new Date(startDate);
            const end = new Date(endDate);
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const dateRange = `${monthNames[start.getMonth()]} ${start.getDate()}-${end.getDate()}, ${start.getFullYear()}`;
            
            // Parse subjects
            let subjects = [];
            try {
                if (details.trim()) {
                    subjects = JSON.parse(details);
                }
            } catch (e) {
                showToast('Invalid JSON format for timetable details', 'error');
                return;
            }
            
            if (timetableId) {
                // Update existing timetable
                const timetable = state.timetables.find(t => t.id === parseInt(timetableId));
                if (timetable) {
                    timetable.class = timetableClass;
                    timetable.term = term;
                    timetable.dateRange = dateRange;
                    timetable.subjects = subjects;
                    timetable.status = status;
                    showToast('Timetable updated successfully!', 'success');
                }
            } else {
                // Create new timetable
                const newTimetable = {
                    id: state.timetables.length + 1,
                    class: timetableClass,
                    term,
                    dateRange,
                    subjects,
                    status
                };
                state.timetables.push(newTimetable);
                showToast('Timetable added successfully!', 'success');
            }
            
            hideModal('timetableModal');
            loadPage('timetable');
        }

        function viewTimetable(id) {
            const timetable = state.timetables.find(t => t.id === id);
            if (!timetable) return;
            
            // Create a simple view of the timetable
            let timetableHTML = `
                <h3>Class ${timetable.class} - ${timetable.term}</h3>
                <p><strong>Date Range:</strong> ${timetable.dateRange}</p>
                <p><strong>Status:</strong> ${timetable.status === 'active' ? 'Active' : 'Inactive'}</p>
            `;
            
            if (timetable.subjects && timetable.subjects.length > 0) {
                timetableHTML += `
                    <h4 style="margin-top: 1rem;">Schedule:</h4>
                    <table class="data-table" style="margin-top: 0.5rem;">
                        <thead>
                            <tr>
                                <th>Day</th>
                                <th>Time</th>
                                <th>Subject</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${timetable.subjects.map(subject => `
                                <tr>
                                    <td>${subject.day}</td>
                                    <td>${subject.time}</td>
                                    <td>${subject.subject}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
            
            showToast(`Viewing timetable for Class ${timetable.class}`, 'info');
            
            // In a real application, this would open a modal with the full timetable
            alert(timetableHTML);
        }

        function downloadTimetable(id) {
            const timetable = state.timetables.find(t => t.id === id);
            if (timetable) {
                showToast(`Downloading timetable for Class ${timetable.class}`, 'info');
                // In a real application, this would generate and download a PDF/Excel file
            }
        }

        function toggleTimetableStatus(id, active) {
            const timetable = state.timetables.find(t => t.id === id);
            if (timetable) {
                timetable.status = active ? 'active' : 'inactive';
                showToast(`Timetable ${active ? 'activated' : 'deactivated'}`, 'success');
            }
        }

        function searchTimetables() {
            const searchTerm = document.getElementById('timetableSearch').value.toLowerCase();
            const cards = document.querySelectorAll('#timetableContainer .card');
            
            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function filterTimetableStatus(status) {
            const buttons = document.querySelectorAll('.timetable-page .filter-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const cards = document.querySelectorAll('#timetableContainer .card');
            
            cards.forEach(card => {
                let show = false;
                const statusBadge = card.querySelector('.status-badge');
                const statusText = statusBadge?.textContent.toLowerCase();
                
                switch(status) {
                    case 'all':
                        show = true;
                        break;
                    case 'active':
                        show = statusText === 'active';
                        break;
                    case 'inactive':
                        show = statusText === 'inactive';
                        break;
                }
                
                card.style.display = show ? '' : 'none';
            });
        }

        function uploadTimetable() {
            showToast('Timetable bulk upload functionality would be implemented here', 'info');
        }

        // Security Functions
        function toggleMasterWebsite(enabled) {
            state.securitySettings.websiteVisibility = enabled;
            showToast(`Website ${enabled ? 'activated' : 'deactivated'}`, enabled ? 'success' : 'warning');
        }

        function toggleChatFeature(enabled) {
            state.securitySettings.chatEnabled = enabled;
            showToast(`Chat feature ${enabled ? 'enabled' : 'disabled'}`, enabled ? 'success' : 'warning');
        }

        function toggleWebsiteTour(enabled) {
            state.securitySettings.websiteTour = enabled;
            showToast(`Website tour ${enabled ? 'enabled' : 'disabled'}`, enabled ? 'success' : 'warning');
        }

        function togglePageVisibility(page, visible) {
            state.securitySettings.pageVisibility[page] = visible;
            showToast(`${formatPageName(page)} page ${visible ? 'activated' : 'deactivated'}`, visible ? 'success' : 'warning');
        }

        function addBannedIP() {
            const ipInput = document.getElementById('newBannedIP');
            const ip = ipInput.value.trim();
            
            if (!ip) {
                showToast('Please enter an IP address', 'error');
                return;
            }
            
            // Simple IP validation
            const ipRegex = /^(\d{1,3}\.){3}\d{1,3}$/;
            if (!ipRegex.test(ip)) {
                showToast('Please enter a valid IP address', 'error');
                return;
            }
            
            state.securitySettings.bannedIPs.push(ip);
            ipInput.value = '';
            showToast(`IP ${ip} added to banned list`, 'success');
            loadPage('security');
        }

        function removeBannedIP(ip) {
            state.securitySettings.bannedIPs = state.securitySettings.bannedIPs.filter(i => i !== ip);
            showToast(`IP ${ip} removed from banned list`, 'success');
            loadPage('security');
        }

        function addBannedCountry() {
            const countryInput = document.getElementById('newBannedCountry');
            const country = countryInput.value.trim();
            
            if (!country) {
                showToast('Please enter a country name', 'error');
                return;
            }
            
            state.securitySettings.bannedCountries.push(country);
            countryInput.value = '';
            showToast(`Country ${country} added to banned list`, 'success');
            loadPage('security');
        }

        function removeBannedCountry(country) {
            state.securitySettings.bannedCountries = state.securitySettings.bannedCountries.filter(c => c !== country);
            showToast(`Country ${country} removed from banned list`, 'success');
            loadPage('security');
        }

        // User Functions
        function addNewUser() {
            document.getElementById('userModalTitle').textContent = 'Add New User';
            
            const formHTML = `
                <form id="userForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="userName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="userEmail" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Role</label>
                            <select class="form-control" id="userRole" required>
                                <option value="admin">Administrator</option>
                                <option value="hr">HR Manager</option>
                                <option value="admission">Admission Officer</option>
                                <option value="teaching">Teaching Staff</option>
                                <option value="it">IT Staff</option>
                                <option value="support">Support Staff</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Password</label>
                            <input type="password" class="form-control" id="userPassword" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Permissions</label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.5rem; margin-top: 0.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permDashboard" checked>
                                <label for="permDashboard">Dashboard</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permCareers">
                                <label for="permCareers">Career Management</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permApplications">
                                <label for="permApplications">Applications</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permBlogs">
                                <label for="permBlogs">Blog Management</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permCarousels">
                                <label for="permCarousels">Carousel Management</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permEnquiries">
                                <label for="permEnquiries">Enquiry Management</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permChat">
                                <label for="permChat">Live Chat</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permTC">
                                <label for="permTC">TC Data</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permTimetable">
                                <label for="permTimetable">Timetable</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permSecurity">
                                <label for="permSecurity">Security</label>
                            </div>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="permUsers">
                                <label for="permUsers">User Management</label>
                            </div>
                        </div>
                    </div>
                </form>
            `;
            
            document.getElementById('userForm').innerHTML = formHTML;
            showModal('userManagementModal');
        }

        function editUser(id) {
            const user = state.users.find(u => u.id === id);
            if (!user) return;
            
            document.getElementById('userModalTitle').textContent = 'Edit User';
            
            const formHTML = `
                <form id="userForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="userName" value="${user.name}" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="userEmail" value="${user.email}" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Role</label>
                            <select class="form-control" id="userRole" required>
                                <option value="super-admin" ${user.role === 'super-admin' ? 'selected' : ''}>Super Administrator</option>
                                <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>Administrator</option>
                                <option value="hr" ${user.role === 'hr' ? 'selected' : ''}>HR Manager</option>
                                <option value="admission" ${user.role === 'admission' ? 'selected' : ''}>Admission Officer</option>
                                <option value="teaching" ${user.role === 'teaching' ? 'selected' : ''}>Teaching Staff</option>
                                <option value="it" ${user.role === 'it' ? 'selected' : ''}>IT Staff</option>
                                <option value="support" ${user.role === 'support' ? 'selected' : ''}>Support Staff</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Password (leave blank to keep current)</label>
                            <input type="password" class="form-control" id="userPassword" placeholder="Enter new password">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Permissions</label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.5rem; margin-top: 0.5rem;">
                            ${Object.entries(user.permissions).map(([permission, allowed]) => `
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <input type="checkbox" id="perm${permission.charAt(0).toUpperCase() + permission.slice(1)}" ${allowed ? 'checked' : ''}>
                                    <label for="perm${permission.charAt(0).toUpperCase() + permission.slice(1)}">${formatPermissionName(permission)}</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </form>
            `;
            
            document.getElementById('userForm').innerHTML = formHTML;
            
            // Store user ID for update
            document.getElementById('userForm').setAttribute('data-id', user.id);
            
            showModal('userManagementModal');
        }

        function saveUser() {
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;
            const role = document.getElementById('userRole').value;
            const password = document.getElementById('userPassword').value;
            const userId = document.getElementById('userForm').getAttribute('data-id');
            
            if (!name || !email || !role) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            // Collect permissions
            const permissions = {};
            const permissionCheckboxes = document.querySelectorAll('#userForm input[type="checkbox"]');
            permissionCheckboxes.forEach(checkbox => {
                const permName = checkbox.id.replace('perm', '').toLowerCase();
                permissions[permName] = checkbox.checked;
            });
            
            if (userId) {
                // Update existing user
                const user = state.users.find(u => u.id === parseInt(userId));
                if (user) {
                    user.name = name;
                    user.email = email;
                    user.role = role;
                    if (password) {
                        user.password = password;
                    }
                    user.permissions = permissions;
                    showToast('User updated successfully!', 'success');
                }
            } else {
                // Create new user
                if (!password) {
                    showToast('Please enter a password for new user', 'error');
                    return;
                }
                
                const newUser = {
                    id: state.users.length + 1,
                    name,
                    email,
                    role,
                    password,
                    permissions
                };
                state.users.push(newUser);
                showToast('User added successfully!', 'success');
            }
            
            hideModal('userManagementModal');
            loadPage('users');
        }

        function deleteUser(id) {
            if (id === 1) {
                showToast('Cannot delete super administrator', 'error');
                return;
            }
            
            if (confirm('Are you sure you want to delete this user?')) {
                state.users = state.users.filter(u => u.id !== id);
                showToast('User deleted successfully', 'success');
                loadPage('users');
            }
        }

        function toggleUserPermission(userId, permission, allowed) {
            const user = state.users.find(u => u.id === userId);
            if (user) {
                user.permissions[permission] = allowed;
                showToast(`Permission ${formatPermissionName(permission)} ${allowed ? 'granted' : 'revoked'}`, allowed ? 'success' : 'warning');
            }
        }

        // User Settings Functions
        function addIP() {
            const ipInput = document.getElementById('newIP');
            const ip = ipInput.value.trim();
            
            if (!ip) {
                showToast('Please enter an IP address', 'error');
                return;
            }
            
            showToast(`IP ${ip} added successfully`, 'success');
            ipInput.value = '';
        }

        function addLocation() {
            const locationInput = document.getElementById('newLocation');
            const location = locationInput.value.trim();
            
            if (!location) {
                showToast('Please enter a location', 'error');
                return;
            }
            
            showToast(`Location ${location} added successfully`, 'success');
            locationInput.value = '';
        }

        function saveUserSettings() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const restrictAccess = document.getElementById('restrictAccess').checked;
            
            if (newPassword && newPassword !== confirmPassword) {
                showToast('New passwords do not match', 'error');
                return;
            }
            
            // In a real application, you would verify current password and update
            if (newPassword) {
                showToast('Password updated successfully', 'success');
            }
            
            showToast('User settings saved successfully', 'success');
            hideModal('userSettingsModal');
        }

        // Global functions for inline event handlers
        window.navigateTo = navigateTo;
        window.showModal = showModal;
        window.hideModal = hideModal;
        window.showToast = showToast;
        window.setPositionType = setPositionType;
        window.saveCareer = saveCareer;
        window.viewCareerDetail = viewCareerDetail;
        window.editCareer = editCareer;
        window.deleteCareer = deleteCareer;
        window.searchCareers = searchCareers;
        window.filterCareers = filterCareers;
        window.exportCareers = exportCareers;
        window.viewApplicationDetail = viewApplicationDetail;
        window.editApplication = editApplication;
        window.contactApplicant = contactApplicant;
        window.sendWhatsApp = sendWhatsApp;
        window.sendEmail = sendEmail;
        window.makeCall = makeCall;
        window.printApplication = printApplication;
        window.searchApplications = searchApplications;
        window.filterApplications = filterApplications;
        window.exportApplications = exportApplications;
        window.viewApplicationsForJob = viewApplicationsForJob;
        window.createNewBlog = createNewBlog;
        window.editBlogPost = editBlogPost;
        window.saveBlog = saveBlog;
        window.toggleBlogVisibility = toggleBlogVisibility;
        window.deleteBlog = deleteBlog;
        window.uploadBlogImage = uploadBlogImage;
        window.addCarouselImage = addCarouselImage;
        window.editCarousel = editCarousel;
        window.saveCarousel = saveCarousel;
        window.deleteCarouselImage = deleteCarouselImage;
        window.uploadCarouselImage = uploadCarouselImage;
        window.viewEnquiryDetail = viewEnquiryDetail;
        window.markAsRead = markAsRead;
        window.markAsUnread = markAsUnread;
        window.moveToFollowup = moveToFollowup;
        window.moveToConverted = moveToConverted;
        window.saveEnquiryNotes = saveEnquiryNotes;
        window.enquiryWhatsApp = enquiryWhatsApp;
        window.enquiryEmail = enquiryEmail;
        window.enquiryCall = enquiryCall;
        window.contactEnquiry = contactEnquiry;
        window.callEnquiry = callEnquiry;
        window.searchEnquiries = searchEnquiries;
        window.filterEnquiries = filterEnquiries;
        window.exportEnquiries = exportEnquiries;
        window.selectChatPage = selectChatPage;
        window.sendChatMessagePage = sendChatMessagePage;
        window.endChatPage = endChatPage;
        window.convertChatToEnquiryPage = convertChatToEnquiryPage;
        window.addTCData = addTCData;
        window.editTCData = editTCData;
        window.saveTCData = saveTCData;
        window.viewTCData = viewTCData;
        window.deleteTCData = deleteTCData;
        window.toggleTCStatus = toggleTCStatus;
        window.searchTCData = searchTCData;
        window.filterTCByYear = filterTCByYear;
        window.filterTCStatus = filterTCStatus;
        window.uploadTCBulk = uploadTCBulk;
        window.addTimetable = addTimetable;
        window.editTimetable = editTimetable;
        window.saveTimetable = saveTimetable;
        window.viewTimetable = viewTimetable;
        window.downloadTimetable = downloadTimetable;
        window.toggleTimetableStatus = toggleTimetableStatus;
        window.searchTimetables = searchTimetables;
        window.filterTimetableStatus = filterTimetableStatus;
        window.uploadTimetable = uploadTimetable;
        window.toggleMasterWebsite = toggleMasterWebsite;
        window.toggleChatFeature = toggleChatFeature;
        window.toggleWebsiteTour = toggleWebsiteTour;
        window.togglePageVisibility = togglePageVisibility;
        window.addBannedIP = addBannedIP;
        window.removeBannedIP = removeBannedIP;
        window.addBannedCountry = addBannedCountry;
        window.removeBannedCountry = removeBannedCountry;
        window.addNewUser = addNewUser;
        window.editUser = editUser;
        window.saveUser = saveUser;
        window.deleteUser = deleteUser;
        window.toggleUserPermission = toggleUserPermission;
        window.addIP = addIP;
        window.addLocation = addLocation;
        window.saveUserSettings = saveUserSettings;
    </script>
</body>
</html>